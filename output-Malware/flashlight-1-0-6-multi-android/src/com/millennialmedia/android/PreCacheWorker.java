// 
// Decompiled by Procyon v0.5.30
// 

package com.millennialmedia.android;

import android.text.TextUtils;
import org.apache.http.Header;
import org.apache.http.HttpEntity;
import android.content.Context;

class PreCacheWorker extends Thread
{
    private static final String TAG = "PreCacheWorker";
    private static boolean busy;
    private Context appContext;
    private DTOCachedVideo[] cachedVideos;
    private volatile boolean downloadedNewVideos;
    private String noVideosToCacheURL;
    
    private PreCacheWorker(final DTOCachedVideo[] cachedVideos, final Context context, final String noVideosToCacheURL) {
        this.downloadedNewVideos = false;
        this.cachedVideos = cachedVideos;
        this.noVideosToCacheURL = noVideosToCacheURL;
        this.appContext = context.getApplicationContext();
    }
    
    private void handleContent(final DTOCachedVideo dtoCachedVideo, final HttpEntity httpEntity) {
        final Header contentType = httpEntity.getContentType();
        if (contentType != null) {
            final String value = contentType.getValue();
            if (value != null && value.equalsIgnoreCase("application/json")) {
                this.handleJson(dtoCachedVideo, httpEntity);
            }
            else if (value != null && value.startsWith("video/")) {
                this.handleVideoFile(dtoCachedVideo, httpEntity);
            }
        }
    }
    
    private void handleJson(final DTOCachedVideo p0, final HttpEntity p1) {
        // 
        // This method could not be decompiled.
        // 
        // Original Bytecode:
        // 
        //     0: aload_2        
        //     1: invokeinterface org/apache/http/HttpEntity.getContent:()Ljava/io/InputStream;
        //     6: invokestatic    com/millennialmedia/android/HttpGetRequest.convertStreamToString:(Ljava/io/InputStream;)Ljava/lang/String;
        //     9: astore          5
        //    11: aload           5
        //    13: invokestatic    android/text/TextUtils.isEmpty:(Ljava/lang/CharSequence;)Z
        //    16: istore          6
        //    18: aconst_null    
        //    19: astore          7
        //    21: iload           6
        //    23: ifne            37
        //    26: new             Lcom/millennialmedia/android/VideoAd;
        //    29: dup            
        //    30: aload           5
        //    32: invokespecial   com/millennialmedia/android/VideoAd.<init>:(Ljava/lang/String;)V
        //    35: astore          7
        //    37: aload           7
        //    39: ifnull          82
        //    42: aload           7
        //    44: invokevirtual   com/millennialmedia/android/VideoAd.isValid:()Z
        //    47: ifeq            82
        //    50: aload           7
        //    52: iconst_1       
        //    53: putfield        com/millennialmedia/android/VideoAd.downloadPriority:I
        //    56: aload_0        
        //    57: getfield        com/millennialmedia/android/PreCacheWorker.appContext:Landroid/content/Context;
        //    60: aconst_null    
        //    61: aload           7
        //    63: new             Lcom/millennialmedia/android/PreCacheWorker$1;
        //    66: dup            
        //    67: aload_0        
        //    68: aload_1        
        //    69: invokespecial   com/millennialmedia/android/PreCacheWorker$1.<init>:(Lcom/millennialmedia/android/PreCacheWorker;Lcom/millennialmedia/android/DTOCachedVideo;)V
        //    72: invokestatic    com/millennialmedia/android/AdCache.startDownloadTask:(Landroid/content/Context;Ljava/lang/String;Lcom/millennialmedia/android/CachedAd;Lcom/millennialmedia/android/AdCache$AdCacheTaskListener;)Z
        //    75: ifeq            111
        //    78: aload_0        
        //    79: invokevirtual   java/lang/Object.wait:()V
        //    82: return         
        //    83: astore          4
        //    85: aload           4
        //    87: invokevirtual   java/lang/IllegalStateException.printStackTrace:()V
        //    90: ldc             "PreCacheWorker"
        //    92: ldc             "Pre cache worker: Millennial ad return failed. Invalid response data."
        //    94: invokestatic    com/millennialmedia/android/MMLog.d:(Ljava/lang/String;Ljava/lang/String;)V
        //    97: return         
        //    98: astore_3       
        //    99: aload_3        
        //   100: invokevirtual   java/io/IOException.printStackTrace:()V
        //   103: ldc             "PreCacheWorker"
        //   105: ldc             "Pre cache worker: Millennial ad return failed. Invalid response data."
        //   107: invokestatic    com/millennialmedia/android/MMLog.d:(Ljava/lang/String;Ljava/lang/String;)V
        //   110: return         
        //   111: aload_1        
        //   112: getfield        com/millennialmedia/android/DTOCachedVideo.preCacheStartURL:Ljava/lang/String;
        //   115: invokestatic    com/millennialmedia/android/MMSDK$Event.logEvent:(Ljava/lang/String;)V
        //   118: aload_1        
        //   119: getfield        com/millennialmedia/android/DTOCachedVideo.preCacheFailedURL:Ljava/lang/String;
        //   122: invokestatic    com/millennialmedia/android/MMSDK$Event.logEvent:(Ljava/lang/String;)V
        //   125: return         
        //   126: astore          8
        //   128: aload           8
        //   130: invokevirtual   java/lang/InterruptedException.printStackTrace:()V
        //   133: ldc             "PreCacheWorker"
        //   135: ldc             "Pre cache worker interrupted: "
        //   137: aload           8
        //   139: invokestatic    com/millennialmedia/android/MMLog.e:(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)V
        //   142: return         
        //    Exceptions:
        //  Try           Handler
        //  Start  End    Start  End    Type                             
        //  -----  -----  -----  -----  ---------------------------------
        //  0      18     83     98     Ljava/lang/IllegalStateException;
        //  0      18     98     111    Ljava/io/IOException;
        //  26     37     83     98     Ljava/lang/IllegalStateException;
        //  26     37     98     111    Ljava/io/IOException;
        //  50     82     126    143    Ljava/lang/InterruptedException;
        //  111    125    126    143    Ljava/lang/InterruptedException;
        // 
        // The error that occurred was:
        // 
        // java.lang.IllegalStateException: Expression is linked from several locations: Label_0082:
        //     at com.strobel.decompiler.ast.Error.expressionLinkedFromMultipleLocations(Error.java:27)
        //     at com.strobel.decompiler.ast.AstOptimizer.mergeDisparateObjectInitializations(AstOptimizer.java:2592)
        //     at com.strobel.decompiler.ast.AstOptimizer.optimize(AstOptimizer.java:235)
        //     at com.strobel.decompiler.ast.AstOptimizer.optimize(AstOptimizer.java:42)
        //     at com.strobel.decompiler.languages.java.ast.AstMethodBodyBuilder.createMethodBody(AstMethodBodyBuilder.java:214)
        //     at com.strobel.decompiler.languages.java.ast.AstMethodBodyBuilder.createMethodBody(AstMethodBodyBuilder.java:99)
        //     at com.strobel.decompiler.languages.java.ast.AstBuilder.createMethodBody(AstBuilder.java:757)
        //     at com.strobel.decompiler.languages.java.ast.AstBuilder.createMethod(AstBuilder.java:655)
        //     at com.strobel.decompiler.languages.java.ast.AstBuilder.addTypeMembers(AstBuilder.java:532)
        //     at com.strobel.decompiler.languages.java.ast.AstBuilder.createTypeCore(AstBuilder.java:499)
        //     at com.strobel.decompiler.languages.java.ast.AstBuilder.createTypeNoCache(AstBuilder.java:141)
        //     at com.strobel.decompiler.languages.java.ast.AstBuilder.createType(AstBuilder.java:130)
        //     at com.strobel.decompiler.languages.java.ast.AstBuilder.addType(AstBuilder.java:105)
        //     at com.strobel.decompiler.languages.java.JavaLanguage.buildAst(JavaLanguage.java:71)
        //     at com.strobel.decompiler.languages.java.JavaLanguage.decompileType(JavaLanguage.java:59)
        //     at com.strobel.decompiler.DecompilerDriver.decompileType(DecompilerDriver.java:317)
        //     at com.strobel.decompiler.DecompilerDriver.decompileJar(DecompilerDriver.java:238)
        //     at com.strobel.decompiler.DecompilerDriver.main(DecompilerDriver.java:123)
        // 
        throw new IllegalStateException("An error occurred while decompiling this method.");
    }
    
    private void handleVideoFile(final DTOCachedVideo dtoCachedVideo, final HttpEntity httpEntity) {
        if (!TextUtils.isEmpty((CharSequence)dtoCachedVideo.videoFileId)) {
            MMSDK$Event.logEvent(dtoCachedVideo.preCacheStartURL);
            if (!AdCache.downloadComponentInternalCache(dtoCachedVideo.url, dtoCachedVideo.videoFileId + "video.dat", this.appContext)) {
                MMSDK$Event.logEvent(dtoCachedVideo.preCacheFailedURL);
                return;
            }
            MMSDK$Event.logEvent(dtoCachedVideo.preCacheCompleteURL);
        }
    }
    
    static void preCacheVideos(final DTOCachedVideo[] array, final Context context, final String s) {
        synchronized (PreCacheWorker.class) {
            if (!PreCacheWorker.busy) {
                PreCacheWorker.busy = true;
                new PreCacheWorker(array, context, s).start();
            }
        }
    }
    
    @Override
    public void run() {
        // 
        // This method could not be decompiled.
        // 
        // Original Bytecode:
        // 
        //     0: aload_0        
        //     1: monitorenter   
        //     2: aload_0        
        //     3: getfield        com/millennialmedia/android/PreCacheWorker.cachedVideos:[Lcom/millennialmedia/android/DTOCachedVideo;
        //     6: ifnull          199
        //     9: aload_0        
        //    10: getfield        com/millennialmedia/android/PreCacheWorker.cachedVideos:[Lcom/millennialmedia/android/DTOCachedVideo;
        //    13: astore          5
        //    15: aload           5
        //    17: arraylength    
        //    18: istore          6
        //    20: iconst_0       
        //    21: istore          7
        //    23: iload           7
        //    25: iload           6
        //    27: if_icmpge       199
        //    30: aload           5
        //    32: iload           7
        //    34: aaload         
        //    35: astore          8
        //    37: new             Lcom/millennialmedia/android/HttpGetRequest;
        //    40: dup            
        //    41: invokespecial   com/millennialmedia/android/HttpGetRequest.<init>:()V
        //    44: aload           8
        //    46: getfield        com/millennialmedia/android/DTOCachedVideo.url:Ljava/lang/String;
        //    49: invokevirtual   com/millennialmedia/android/HttpGetRequest.get:(Ljava/lang/String;)Lorg/apache/http/HttpResponse;
        //    52: astore          10
        //    54: aload           10
        //    56: ifnonnull       69
        //    59: ldc             "PreCacheWorker"
        //    61: ldc             "Pre cache worker: HTTP response is null"
        //    63: invokestatic    com/millennialmedia/android/MMLog.d:(Ljava/lang/String;Ljava/lang/String;)V
        //    66: goto            257
        //    69: aload           10
        //    71: invokeinterface org/apache/http/HttpResponse.getEntity:()Lorg/apache/http/HttpEntity;
        //    76: astore          11
        //    78: aload           11
        //    80: ifnonnull       166
        //    83: ldc             "PreCacheWorker"
        //    85: ldc             "Pre cache worker: Null HTTP entity"
        //    87: invokestatic    com/millennialmedia/android/MMLog.d:(Ljava/lang/String;Ljava/lang/String;)V
        //    90: goto            257
        //    93: astore_1       
        //    94: ldc             Lcom/millennialmedia/android/PreCacheWorker;.class
        //    96: monitorenter   
        //    97: iconst_0       
        //    98: putstatic       com/millennialmedia/android/PreCacheWorker.busy:Z
        //   101: aload_0        
        //   102: getfield        com/millennialmedia/android/PreCacheWorker.downloadedNewVideos:Z
        //   105: ifne            132
        //   108: aload_0        
        //   109: getfield        com/millennialmedia/android/PreCacheWorker.noVideosToCacheURL:Ljava/lang/String;
        //   112: invokestatic    android/text/TextUtils.isEmpty:(Ljava/lang/CharSequence;)Z
        //   115: ifne            132
        //   118: aload_0        
        //   119: getfield        com/millennialmedia/android/PreCacheWorker.cachedVideos:[Lcom/millennialmedia/android/DTOCachedVideo;
        //   122: ifnonnull       132
        //   125: aload_0        
        //   126: getfield        com/millennialmedia/android/PreCacheWorker.noVideosToCacheURL:Ljava/lang/String;
        //   129: invokestatic    com/millennialmedia/android/MMSDK$Event.logEvent:(Ljava/lang/String;)V
        //   132: ldc             Lcom/millennialmedia/android/PreCacheWorker;.class
        //   134: monitorexit    
        //   135: aload_1        
        //   136: athrow         
        //   137: astore_2       
        //   138: aload_0        
        //   139: monitorexit    
        //   140: aload_2        
        //   141: athrow         
        //   142: astore          9
        //   144: ldc             "PreCacheWorker"
        //   146: ldc             "Pre cache worker HTTP error: %s"
        //   148: iconst_1       
        //   149: anewarray       Ljava/lang/Object;
        //   152: dup            
        //   153: iconst_0       
        //   154: aload           9
        //   156: aastore        
        //   157: invokestatic    java/lang/String.format:(Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;
        //   160: invokestatic    com/millennialmedia/android/MMLog.d:(Ljava/lang/String;Ljava/lang/String;)V
        //   163: goto            257
        //   166: aload           11
        //   168: invokeinterface org/apache/http/HttpEntity.getContentLength:()J
        //   173: lconst_0       
        //   174: lcmp           
        //   175: ifne            188
        //   178: ldc             "PreCacheWorker"
        //   180: ldc             "Pre cache worker: Millennial ad return failed. Zero content length returned."
        //   182: invokestatic    com/millennialmedia/android/MMLog.d:(Ljava/lang/String;Ljava/lang/String;)V
        //   185: goto            257
        //   188: aload_0        
        //   189: aload           8
        //   191: aload           11
        //   193: invokespecial   com/millennialmedia/android/PreCacheWorker.handleContent:(Lcom/millennialmedia/android/DTOCachedVideo;Lorg/apache/http/HttpEntity;)V
        //   196: goto            257
        //   199: ldc             Lcom/millennialmedia/android/PreCacheWorker;.class
        //   201: monitorenter   
        //   202: iconst_0       
        //   203: putstatic       com/millennialmedia/android/PreCacheWorker.busy:Z
        //   206: aload_0        
        //   207: getfield        com/millennialmedia/android/PreCacheWorker.downloadedNewVideos:Z
        //   210: ifne            237
        //   213: aload_0        
        //   214: getfield        com/millennialmedia/android/PreCacheWorker.noVideosToCacheURL:Ljava/lang/String;
        //   217: invokestatic    android/text/TextUtils.isEmpty:(Ljava/lang/CharSequence;)Z
        //   220: ifne            237
        //   223: aload_0        
        //   224: getfield        com/millennialmedia/android/PreCacheWorker.cachedVideos:[Lcom/millennialmedia/android/DTOCachedVideo;
        //   227: ifnonnull       237
        //   230: aload_0        
        //   231: getfield        com/millennialmedia/android/PreCacheWorker.noVideosToCacheURL:Ljava/lang/String;
        //   234: invokestatic    com/millennialmedia/android/MMSDK$Event.logEvent:(Ljava/lang/String;)V
        //   237: ldc             Lcom/millennialmedia/android/PreCacheWorker;.class
        //   239: monitorexit    
        //   240: aload_0        
        //   241: monitorexit    
        //   242: return         
        //   243: astore_3       
        //   244: ldc             Lcom/millennialmedia/android/PreCacheWorker;.class
        //   246: monitorexit    
        //   247: aload_3        
        //   248: athrow         
        //   249: astore          4
        //   251: ldc             Lcom/millennialmedia/android/PreCacheWorker;.class
        //   253: monitorexit    
        //   254: aload           4
        //   256: athrow         
        //   257: iinc            7, 1
        //   260: goto            23
        //    Exceptions:
        //  Try           Handler
        //  Start  End    Start  End    Type                 
        //  -----  -----  -----  -----  ---------------------
        //  2      20     93     249    Any
        //  30     37     93     249    Any
        //  37     54     142    166    Ljava/lang/Exception;
        //  37     54     93     249    Any
        //  59     66     142    166    Ljava/lang/Exception;
        //  59     66     93     249    Any
        //  69     78     142    166    Ljava/lang/Exception;
        //  69     78     93     249    Any
        //  83     90     93     249    Any
        //  94     97     137    142    Any
        //  97     132    243    249    Any
        //  132    135    243    249    Any
        //  135    137    137    142    Any
        //  144    163    93     249    Any
        //  166    185    93     249    Any
        //  188    196    93     249    Any
        //  199    202    137    142    Any
        //  202    237    249    257    Any
        //  237    240    249    257    Any
        //  244    249    137    142    Any
        //  251    257    137    142    Any
        // 
        // The error that occurred was:
        // 
        // java.lang.IllegalStateException: Expression is linked from several locations: Label_0132:
        //     at com.strobel.decompiler.ast.Error.expressionLinkedFromMultipleLocations(Error.java:27)
        //     at com.strobel.decompiler.ast.AstOptimizer.mergeDisparateObjectInitializations(AstOptimizer.java:2592)
        //     at com.strobel.decompiler.ast.AstOptimizer.optimize(AstOptimizer.java:235)
        //     at com.strobel.decompiler.ast.AstOptimizer.optimize(AstOptimizer.java:42)
        //     at com.strobel.decompiler.languages.java.ast.AstMethodBodyBuilder.createMethodBody(AstMethodBodyBuilder.java:214)
        //     at com.strobel.decompiler.languages.java.ast.AstMethodBodyBuilder.createMethodBody(AstMethodBodyBuilder.java:99)
        //     at com.strobel.decompiler.languages.java.ast.AstBuilder.createMethodBody(AstBuilder.java:757)
        //     at com.strobel.decompiler.languages.java.ast.AstBuilder.createMethod(AstBuilder.java:655)
        //     at com.strobel.decompiler.languages.java.ast.AstBuilder.addTypeMembers(AstBuilder.java:532)
        //     at com.strobel.decompiler.languages.java.ast.AstBuilder.createTypeCore(AstBuilder.java:499)
        //     at com.strobel.decompiler.languages.java.ast.AstBuilder.createTypeNoCache(AstBuilder.java:141)
        //     at com.strobel.decompiler.languages.java.ast.AstBuilder.createType(AstBuilder.java:130)
        //     at com.strobel.decompiler.languages.java.ast.AstBuilder.addType(AstBuilder.java:105)
        //     at com.strobel.decompiler.languages.java.JavaLanguage.buildAst(JavaLanguage.java:71)
        //     at com.strobel.decompiler.languages.java.JavaLanguage.decompileType(JavaLanguage.java:59)
        //     at com.strobel.decompiler.DecompilerDriver.decompileType(DecompilerDriver.java:317)
        //     at com.strobel.decompiler.DecompilerDriver.decompileJar(DecompilerDriver.java:238)
        //     at com.strobel.decompiler.DecompilerDriver.main(DecompilerDriver.java:123)
        // 
        throw new IllegalStateException("An error occurred while decompiling this method.");
    }
}
