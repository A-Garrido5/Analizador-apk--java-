// 
// Decompiled by Procyon v0.5.30
// 

package com.flurry.sdk;

import android.view.ViewGroup;
import android.view.MotionEvent;
import android.util.DisplayMetrics;
import android.widget.PopupWindow$OnDismissListener;
import android.view.KeyEvent;
import android.view.View$OnKeyListener;
import java.util.Map;
import java.util.Collections;
import android.graphics.drawable.Drawable;
import android.os.Build$VERSION;
import android.graphics.drawable.GradientDrawable;
import android.view.View$OnClickListener;
import android.view.View;
import android.view.ViewGroup$LayoutParams;
import android.widget.RelativeLayout$LayoutParams;
import android.os.Message;
import android.widget.ProgressBar;
import android.widget.PopupWindow;
import android.content.Context;
import java.lang.ref.WeakReference;
import android.widget.RelativeLayout;
import android.annotation.SuppressLint;
import android.os.Handler;
import java.util.concurrent.atomic.AtomicBoolean;
import android.widget.ImageButton;
import android.graphics.Bitmap;
import android.widget.FrameLayout;

public class z extends FrameLayout implements fb$a
{
    public static int a;
    private static int e;
    private static int f;
    private boolean A;
    private boolean B;
    private final String C;
    private Bitmap D;
    private Bitmap E;
    private Bitmap F;
    private Bitmap G;
    private ImageButton H;
    private ImageButton I;
    private ImageButton J;
    private g K;
    private al L;
    private AtomicBoolean M;
    @SuppressLint({ "HandlerLeak" })
    private Handler N;
    fa b;
    do c;
    RelativeLayout d;
    private WeakReference g;
    private Context h;
    private PopupWindow i;
    private ProgressBar j;
    private boolean k;
    private boolean l;
    private boolean m;
    private boolean n;
    private boolean o;
    private boolean p;
    private boolean q;
    private boolean r;
    private boolean s;
    private boolean t;
    private boolean u;
    private int v;
    private long w;
    private boolean x;
    private boolean y;
    private boolean z;
    
    public z(final Context context, final long n, final boolean b, final boolean b2, final boolean b3) {
        super(context);
        this.g = new WeakReference(null);
        this.r = false;
        this.t = false;
        this.u = false;
        this.v = 0;
        this.w = 0L;
        this.C = z.class.getSimpleName();
        this.M = new AtomicBoolean(false);
        this.N = new Handler() {
            public void handleMessage(final Message message) {
                switch (message.what) {
                    default: {}
                    case 1: {
                        eo.a(3, com.flurry.sdk.z.this.C, "HERE IN FADE_OUT");
                        com.flurry.sdk.z.this.h();
                    }
                    case 2: {
                        eo.a(3, com.flurry.sdk.z.this.C, "HERE IN setProgress " + com.flurry.sdk.z.this.t());
                    }
                }
            }
        };
        com.flurry.sdk.z.e = fc.b(16);
        com.flurry.sdk.z.f = fc.b(5);
        com.flurry.sdk.z.a = fc.b(35);
        this.a(context, new aa(), n, b, b2, b3);
    }
    
    private void a(final Context h, final aa aa, final long w, final boolean x, final boolean y, final boolean z) {
        this.h = h;
        this.K = null;
        this.n = true;
        this.o = true;
        this.p = true;
        this.q = true;
        this.w = w;
        this.x = x;
        this.y = y;
        this.z = z;
        aa.f();
        this.D = aa.b();
        this.E = aa.c();
        this.F = aa.d();
        this.G = aa.e();
    }
    
    private af getMediaPlayer() {
        return (af)this.g.get();
    }
    
    private void l() {
        final RelativeLayout$LayoutParams relativeLayout$LayoutParams = new RelativeLayout$LayoutParams(-2, -2);
        relativeLayout$LayoutParams.setMargins(com.flurry.sdk.z.f, com.flurry.sdk.z.f, com.flurry.sdk.z.f, com.flurry.sdk.z.f);
        relativeLayout$LayoutParams.addRule(10);
        relativeLayout$LayoutParams.addRule(11);
        ((ViewGroup)this.d).addView(this.q(), (ViewGroup$LayoutParams)relativeLayout$LayoutParams);
    }
    
    private void m() {
        final RelativeLayout$LayoutParams relativeLayout$LayoutParams = new RelativeLayout$LayoutParams(-2, -2);
        relativeLayout$LayoutParams.addRule(12);
        relativeLayout$LayoutParams.addRule(11);
        relativeLayout$LayoutParams.setMargins(com.flurry.sdk.z.e, com.flurry.sdk.z.e, com.flurry.sdk.z.e, com.flurry.sdk.z.e);
        ((ViewGroup)this.d).addView(this.r(), (ViewGroup$LayoutParams)relativeLayout$LayoutParams);
    }
    
    private void n() {
        final RelativeLayout$LayoutParams relativeLayout$LayoutParams = new RelativeLayout$LayoutParams(-2, -2);
        relativeLayout$LayoutParams.addRule(13);
        relativeLayout$LayoutParams.setMargins(com.flurry.sdk.z.e, com.flurry.sdk.z.e, com.flurry.sdk.z.e, com.flurry.sdk.z.e);
        ((ViewGroup)this.d).addView(this.p(), (ViewGroup$LayoutParams)relativeLayout$LayoutParams);
    }
    
    private void o() {
        if (this.L == null) {
            this.L = new al(this.h, com.flurry.sdk.z.a, com.flurry.sdk.z.a);
        }
        final RelativeLayout$LayoutParams relativeLayout$LayoutParams = new RelativeLayout$LayoutParams(-2, -2);
        relativeLayout$LayoutParams.addRule(12);
        relativeLayout$LayoutParams.addRule(9);
        relativeLayout$LayoutParams.setMargins(com.flurry.sdk.z.e, com.flurry.sdk.z.e, com.flurry.sdk.z.e, com.flurry.sdk.z.e);
        this.d.addView(this.L.a(), (ViewGroup$LayoutParams)relativeLayout$LayoutParams);
        if (this.B) {
            this.L.a().setVisibility(0);
            return;
        }
        this.L.a().setVisibility(8);
    }
    
    @SuppressLint({ "NewApi" })
    private View p() {
        (this.H = new ImageButton(this.getContext())).setPadding(0, 0, 0, 0);
        this.H.setBackgroundColor(0);
        this.H.setImageBitmap(this.F);
        this.H.setOnClickListener((View$OnClickListener)new View$OnClickListener() {
            public void onClick(final View view) {
                com.flurry.sdk.z.this.u();
                com.flurry.sdk.z.this.h();
            }
        });
        if (this.getMediaPlayer() != null && this.getMediaPlayer().getCurrentPosition() <= this.getOffsetStartTime()) {
            this.H.setVisibility(0);
        }
        else {
            this.H.setVisibility(8);
        }
        return (View)this.H;
    }
    
    @SuppressLint({ "NewApi" })
    private View q() {
        (this.I = new ImageButton(this.getContext())).setPadding(0, 0, 0, 0);
        this.I.setImageBitmap(this.D);
        final GradientDrawable gradientDrawable = new GradientDrawable();
        gradientDrawable.setColor(-16777216);
        gradientDrawable.setShape(1);
        gradientDrawable.setAlpha(178);
        if (Build$VERSION.SDK_INT >= 16) {
            this.I.setBackground((Drawable)gradientDrawable);
        }
        else {
            this.I.setBackgroundDrawable((Drawable)gradientDrawable);
        }
        this.I.setOnClickListener((View$OnClickListener)new View$OnClickListener() {
            public void onClick(final View view) {
                eo.a(3, com.flurry.sdk.z.this.C, "Show video close button.");
                if (com.flurry.sdk.z.this.K != null) {
                    com.flurry.sdk.z.this.K.a();
                }
                com.flurry.sdk.z.this.d();
            }
        });
        if (this.l) {
            this.I.setVisibility(0);
        }
        else {
            this.I.setVisibility(8);
        }
        return (View)this.I;
    }
    
    private View r() {
        (this.J = new ImageButton(this.getContext())).setPadding(0, 0, 0, 0);
        this.J.setBackgroundColor(0);
        this.J.setImageBitmap(this.G);
        this.J.setOnClickListener((View$OnClickListener)new View$OnClickListener() {
            public void onClick(final View view) {
                eo.a(3, com.flurry.sdk.z.this.C, "Show video more info button.");
                if (com.flurry.sdk.z.this.K != null) {
                    com.flurry.sdk.z.this.K.a("clicked", Collections.emptyMap(), com.flurry.sdk.z.this.K.getAdUnit(), com.flurry.sdk.z.this.K.getAdLog(), com.flurry.sdk.z.this.K.getAdFrameIndex(), 0);
                    com.flurry.sdk.z.this.J.setVisibility(8);
                }
            }
        });
        if (this.A) {
            this.J.setVisibility(0);
        }
        else {
            this.J.setVisibility(8);
        }
        return (View)this.J;
    }
    
    private void s() {
        eo.a(3, this.C, "showPlayerAssets.");
        if (this.H != null && this.getMediaPlayer() != null && !this.getMediaPlayer().isPlaying() && this.getMediaPlayer().getCurrentPosition() <= this.getOffsetStartTime()) {
            this.H.setVisibility(0);
        }
        if (this.L != null && this.B) {
            this.L.a().setVisibility(0);
        }
        if (this.I != null && this.l) {
            this.I.setVisibility(0);
        }
        if (this.J != null && this.A) {
            this.J.setVisibility(0);
        }
    }
    
    private int t() {
        int currentPosition;
        if (this.getMediaPlayer() == null || this.m) {
            currentPosition = 0;
        }
        else {
            currentPosition = this.getMediaPlayer().getCurrentPosition();
            final int duration = this.getMediaPlayer().getDuration();
            if (this.j != null) {
                if (duration > 0) {
                    this.j.setProgress((int)(1000L * currentPosition / duration));
                }
                this.j.setSecondaryProgress(this.getMediaPlayer().getBufferPercentage() * 10);
                return currentPosition;
            }
        }
        return currentPosition;
    }
    
    private void u() {
        eo.a(3, this.C, "***********doPauseResume");
        if (this.getMediaPlayer() != null) {
            if (!this.getMediaPlayer().isPlaying()) {
                this.getMediaPlayer().start();
                return;
            }
            this.getMediaPlayer().pause();
        }
    }
    
    public void a() {
        if (this.i == null) {
            (this.i = new PopupWindow(this.h)).setBackgroundDrawable((Drawable)null);
        }
        else {
            eo.a(3, this.C, "PopupWindow exists so using current one!");
        }
        this.i.setFocusable(true);
        if (this.d == null) {
            (this.d = new RelativeLayout(this.h)).setBackgroundColor(0);
        }
        else {
            this.d.removeAllViews();
        }
        this.l();
        if (!this.x && this.getMediaPlayer() != null && this.getMediaPlayer().getCurrentPosition() <= this.getOffsetStartTime()) {
            this.n();
        }
        if (this.y) {
            this.o();
        }
        if (this.z) {
            this.m();
        }
        this.d.setFocusableInTouchMode(true);
        this.d.setOnKeyListener((View$OnKeyListener)new View$OnKeyListener() {
            public boolean onKey(final View view, final int n, final KeyEvent keyEvent) {
                if (n == 4) {
                    if (com.flurry.sdk.z.this.l) {
                        eo.a(3, com.flurry.sdk.z.this.C, "IN KEYCODE BACK");
                        if (com.flurry.sdk.z.this.i != null && com.flurry.sdk.z.this.i.isShowing()) {
                            eo.a(3, com.flurry.sdk.z.this.C, "dismissing popup");
                            com.flurry.sdk.z.this.d();
                        }
                    }
                    return true;
                }
                return false;
            }
        });
        this.i.setContentView((View)this.d);
        this.i.setOnDismissListener((PopupWindow$OnDismissListener)new PopupWindow$OnDismissListener() {
            public void onDismiss() {
                eo.a(3, com.flurry.sdk.z.this.C, "here in onDismiss ");
            }
        });
        if (!this.r) {
            this.j();
        }
        if (this.c == null) {
            this.c = do.a();
        }
        this.c.a(new ff() {
            @Override
            public void a() {
                if (!com.flurry.sdk.z.this.M.get()) {
                    eo.a(3, com.flurry.sdk.z.this.C, "Initializing popUp");
                    com.flurry.sdk.z.this.i.showAtLocation((View)com.flurry.sdk.z.this.d, 17, 0, 0);
                    com.flurry.sdk.z.this.i.update(0, 0, com.flurry.sdk.z.this.getWidthDimensions(), com.flurry.sdk.z.this.getHeightDimensions());
                    return;
                }
                eo.a(3, com.flurry.sdk.z.this.C, "Popup initialization not required.");
            }
        }, 100L);
    }
    
    public void a(final int n) {
        eo.a(3, this.C, "***********show called");
        if (!this.k && this.i != null) {
            eo.a(3, this.C, "********showing player assets in show()");
            this.s();
            this.k = true;
        }
        this.N.sendEmptyMessage(2);
        final Message obtainMessage = this.N.obtainMessage(1);
        if (n != 0) {
            this.N.removeMessages(1);
            this.N.sendMessageDelayed(obtainMessage, (long)n);
        }
    }
    
    public void a(final int n, final float n2) {
        if (this.I != null && n2 >= this.w && !this.l) {
            this.I.setVisibility(0);
            this.l = true;
        }
        if (this.L != null && n2 > 0.0f) {
            if (!this.B) {
                this.B = true;
                this.L.a().setVisibility(0);
            }
            this.L.a(n, this.k);
        }
        if (this.J != null && n2 >= 3000.0f && !this.A && !this.t) {
            this.A = true;
            this.J.setVisibility(0);
        }
        if (this.H != null && n2 > this.getOffsetStartTime() && this.H.isShown()) {
            this.H.setVisibility(8);
        }
    }
    
    public void a(final fb fb) {
        if (this.getMediaPlayer() != null) {
            final float n = this.getMediaPlayer().getDuration();
            final float n2 = this.getMediaPlayer().getCurrentPosition();
            final int n3 = (int)Math.abs((n - n2) / 1000.0f);
            if (this.L != null) {
                this.L.a((int)n);
            }
            this.a(n3, n2);
            if (n2 > this.getOffsetStartTime() && this.n && this.K != null) {
                this.n = false;
                this.K.a("videoStart", Collections.emptyMap(), this.K.getAdUnit(), this.K.getAdLog(), this.K.getAdFrameIndex(), 0);
            }
            final float n4 = n2 / n;
            if (n4 >= 0.25 && this.o && this.K != null) {
                this.o = false;
                this.K.a("videoFirstQuartile", Collections.emptyMap(), this.K.getAdUnit(), this.K.getAdLog(), this.K.getAdFrameIndex(), 0);
            }
            if (n4 >= 0.5 && this.p && this.K != null) {
                this.p = false;
                this.K.a("videoMidpoint", Collections.emptyMap(), this.K.getAdUnit(), this.K.getAdLog(), this.K.getAdFrameIndex(), 0);
            }
            if (n4 >= 0.75 && this.q && this.K != null) {
                this.q = false;
                this.K.a("videoThirdQuartile", Collections.emptyMap(), this.K.getAdUnit(), this.K.getAdLog(), this.K.getAdFrameIndex(), 0);
            }
        }
    }
    
    public void b() {
        if (this.i != null && this.i.isShowing()) {
            this.i.update(0, 0, this.getWidthDimensions(), this.getHeightDimensions());
        }
    }
    
    public boolean c() {
        return this.u;
    }
    
    public void d() {
        if (this.i != null && this.i.isShowing()) {
            eo.a(3, this.C, "dismissing popup");
            this.i.dismiss();
        }
        eo.a(3, this.C, "END OF DISMISS POPUP");
    }
    
    public boolean dispatchKeyEvent(final KeyEvent keyEvent) {
        final int keyCode = keyEvent.getKeyCode();
        eo.a(3, this.C, "HERE IN dispatchKeyEvent");
        if (keyEvent.getRepeatCount() == 0 && keyEvent.getAction() == 0 && (keyCode == 79 || keyCode == 85 || keyCode == 62)) {
            this.u();
            this.e();
            return true;
        }
        if (keyCode == 4 || keyCode == 82) {
            this.h();
            return true;
        }
        this.e();
        return super.dispatchKeyEvent(keyEvent);
    }
    
    public void e() {
        this.a(3000);
    }
    
    public void f() {
        eo.a(3, this.C, "hidePlayerAssets.");
        if (this.H != null) {
            this.H.setVisibility(8);
        }
    }
    
    public boolean g() {
        return this.k;
    }
    
    public boolean getAutoPlay() {
        return this.x;
    }
    
    public ImageButton getCloseButton() {
        return this.I;
    }
    
    public int getHeightDimensions() {
        final DisplayMetrics b = fc.b();
        eo.a(3, this.C, "height is " + b.heightPixels);
        return b.heightPixels;
    }
    
    public ImageButton getMoreInfoButton() {
        return this.J;
    }
    
    public boolean getMoreInfoClicked() {
        return this.s;
    }
    
    public int getOffsetStartTime() {
        return this.v;
    }
    
    public ImageButton getPauseButton() {
        return this.H;
    }
    
    public al getTimerView() {
        return this.L;
    }
    
    public int getWidthDimensions() {
        final DisplayMetrics b = fc.b();
        eo.a(3, this.C, "width is " + b.widthPixels);
        return b.widthPixels;
    }
    
    public void h() {
        eo.a(3, this.C, "HERE IN HIDE");
        if (this.i == null || !this.k) {
            return;
        }
        while (true) {
            try {
                eo.a(3, this.C, "********hiding player assets in hide()");
                this.f();
                this.k = false;
            }
            catch (IllegalArgumentException ex) {
                eo.a(5, this.C, "already removed");
                continue;
            }
            break;
        }
    }
    
    public void i() {
        if (this.s || this.c()) {
            if (this.i != null) {
                this.d();
            }
            this.a();
            this.setmCloseConfirmDialogClicked(false);
        }
        if (!this.k && this.i != null) {
            this.e();
        }
    }
    
    public void j() {
        eo.a(3, this.C, "***********addTimerListener hit");
        if (this.b == null) {
            this.b = fa.a();
        }
        this.b.a(this);
        this.r = true;
    }
    
    public void k() {
        eo.a(3, this.C, "***********removeTimerListener hit");
        if (this.b == null) {
            this.b = fa.a();
        }
        this.b.b(this);
        this.r = false;
    }
    
    public boolean onTrackballEvent(final MotionEvent motionEvent) {
        eo.a(3, this.C, "HERE IN onTrackballEvent");
        this.e();
        return false;
    }
    
    public void setAdUnityView(final g k) {
        this.K = k;
    }
    
    public void setEnabled(final boolean b) {
        if (this.j != null) {
            this.j.setEnabled(b);
        }
        super.setEnabled(b);
    }
    
    public void setFlurryCore(final do c) {
        this.c = c;
    }
    
    public void setInitialVideoMidpoint(final boolean p) {
        this.p = p;
    }
    
    public void setIntialVideoFirstQuartile(final boolean o) {
        this.o = o;
    }
    
    public void setIntialVideoStart(final boolean n) {
        this.n = n;
    }
    
    public void setIntialVideoThirdQuartile(final boolean q) {
        this.q = q;
    }
    
    public void setIsMediaPlayerReleased(final boolean b) {
        this.M.set(b);
    }
    
    public void setMediaPlayer(final f f) {
        this.g = new WeakReference((T)f);
        eo.a(3, this.C, "Here is adUnityViewView: " + f);
    }
    
    public void setOffsetStartTime(final int v) {
        this.v = v;
    }
    
    public void setTickManager(final fa b) {
        this.b = b;
    }
    
    public void setTimerView(final al l) {
        this.L = l;
    }
    
    public void setVideoState(final am am) {
        boolean q = true;
        if (am != null) {
            this.n = (!am.b() && q);
            this.o = (!am.c() && q);
            this.p = (!am.d() && q);
            if (am.e()) {
                q = false;
            }
            this.q = q;
            this.s = am.f();
            this.t = am.h();
            this.A = false;
        }
    }
    
    public void setmCloseConfirmDialogClicked(final boolean u) {
        this.u = u;
    }
}
