// 
// Decompiled by Procyon v0.5.30
// 

package com.google.android.gms.tagmanager;

import android.app.PendingIntent;
import com.google.android.gms.common.api.Status;
import com.google.android.gms.common.api.Result;
import com.google.android.gms.internal.c$f;
import com.google.android.gms.internal.it$a;
import com.google.android.gms.internal.gn;
import android.content.Context;
import com.google.android.gms.internal.c$j;
import com.google.android.gms.internal.gl;
import android.os.Looper;
import com.google.android.gms.common.api.a$a;

class o extends a$a
{
    private final Looper AS;
    private final String WJ;
    private long WO;
    private final TagManager WW;
    private final o$d WZ;
    private final gl Wv;
    private final cf Xa;
    private final int Xb;
    private o$f Xc;
    private volatile n Xd;
    private volatile boolean Xe;
    private c$j Xf;
    private String Xg;
    private o$e Xh;
    private o$a Xi;
    private final Context mContext;
    
    o(final Context mContext, final TagManager ww, Looper mainLooper, final String wj, final int xb, final o$f xc, final o$e xh, final gl wv, final cf xa) {
        Looper mainLooper2;
        if (mainLooper == null) {
            mainLooper2 = Looper.getMainLooper();
        }
        else {
            mainLooper2 = mainLooper;
        }
        super(mainLooper2);
        this.mContext = mContext;
        this.WW = ww;
        if (mainLooper == null) {
            mainLooper = Looper.getMainLooper();
        }
        this.AS = mainLooper;
        this.WJ = wj;
        this.Xb = xb;
        this.Xc = xc;
        this.Xh = xh;
        this.WZ = new o$d(this, null);
        this.Xf = new c$j();
        this.Wv = wv;
        this.Xa = xa;
        if (this.kk()) {
            this.br(cd.kT().kV());
        }
    }
    
    public o(final Context context, final TagManager tagManager, final Looper looper, final String s, final int n, final r r) {
        this(context, tagManager, looper, s, n, new cp(context, s), new co(context, s, r), gn.ft(), new bf(30, 900000L, 5000L, "refreshing", gn.ft()));
    }
    
    private void C(final boolean b) {
        this.Xc.a(new o$b(this, null));
        this.Xh.a(new o$c(this, null));
        final cq$c ca = this.Xc.ca(this.Xb);
        if (ca != null) {
            this.Xd = new n(this.WW, this.AS, new Container(this.mContext, this.WW.getDataLayer(), this.WJ, 0L, ca), this.WZ);
        }
        this.Xi = new o$a() {
            @Override
            public boolean b(final Container container) {
                if (b) {
                    if (43200000L + container.getLastRefreshTime() < o.this.Wv.currentTimeMillis()) {
                        return false;
                    }
                }
                else if (container.isDefault()) {
                    return false;
                }
                return true;
            }
        };
        if (this.kk()) {
            this.Xh.d(0L, "");
            return;
        }
        this.Xc.km();
    }
    
    private void a(final c$j aaZ) {
        synchronized (this) {
            if (this.Xc != null) {
                final it$a it$a = new it$a();
                it$a.aaY = this.WO;
                it$a.fK = new c$f();
                it$a.aaZ = aaZ;
                this.Xc.b(it$a);
            }
        }
    }
    
    private void a(final c$j xf, final long wo, final boolean b) {
        // monitorenter(this)
        Label_0021: {
            if (!b) {
                break Label_0021;
            }
            while (true) {
                while (true) {
                    Container container = null;
                    Label_0172: {
                        try {
                            if (!this.Xe) {
                                if (this.isReady()) {
                                    final n xd = this.Xd;
                                }
                                this.Xf = xf;
                                this.WO = wo;
                                this.t(Math.max(0L, Math.min(43200000L, 43200000L + this.WO - this.Wv.currentTimeMillis())));
                                container = new Container(this.mContext, this.WW.getDataLayer(), this.WJ, wo, xf);
                                if (this.Xd != null) {
                                    break Label_0172;
                                }
                                this.Xd = new n(this.WW, this.AS, container, this.WZ);
                                if (!this.isReady() && this.Xi.b(container)) {
                                    this.a(this.Xd);
                                }
                            }
                            return;
                        }
                        finally {
                        }
                        // monitorexit(this)
                    }
                    this.Xd.a(container);
                    continue;
                }
            }
        }
    }
    
    private boolean kk() {
        final cd kt = cd.kT();
        return (kt.kU() == cd$a.YU || kt.kU() == cd$a.YV) && this.WJ.equals(kt.getContainerId());
    }
    
    private void t(final long n) {
        synchronized (this) {
            if (this.Xh == null) {
                bh.z("Refresh requested, but no network load scheduler.");
            }
            else {
                this.Xh.d(n, this.Xf.fL);
            }
        }
    }
    
    protected ContainerHolder ac(final Status status) {
        if (this.Xd != null) {
            return this.Xd;
        }
        if (status == Status.By) {
            bh.w("timer expired: setting result to failure");
        }
        return new n(status);
    }
    
    void br(final String xg) {
        synchronized (this) {
            this.Xg = xg;
            if (this.Xh != null) {
                this.Xh.bu(xg);
            }
        }
    }
    
    String ke() {
        synchronized (this) {
            return this.Xg;
        }
    }
    
    public void kh() {
        final cq$c ca = this.Xc.ca(this.Xb);
        if (ca != null) {
            this.a(new n(this.WW, this.AS, new Container(this.mContext, this.WW.getDataLayer(), this.WJ, 0L, ca), new n$a() {
                @Override
                public void br(final String s) {
                    o.this.br(s);
                }
                
                @Override
                public String ke() {
                    return o.this.ke();
                }
                
                @Override
                public void kg() {
                    bh.z("Refresh ignored: container loaded as default only.");
                }
            }));
        }
        else {
            bh.w("Default was requested, but no default container was found");
            this.a(this.ac(new Status(10, "Default was requested, but no default container was found", null)));
        }
        this.Xh = null;
        this.Xc = null;
    }
    
    public void ki() {
        this.C(false);
    }
    
    public void kj() {
        this.C(true);
    }
}
