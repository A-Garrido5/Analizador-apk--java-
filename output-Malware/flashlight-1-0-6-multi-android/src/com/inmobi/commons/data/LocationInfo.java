// 
// Decompiled by Procyon v0.5.30
// 

package com.inmobi.commons.data;

import com.inmobi.commons.internal.Log;
import android.location.Criteria;
import java.util.List;
import com.inmobi.commons.internal.InternalSDKUtil;
import android.location.Location;
import android.location.LocationManager;

public class LocationInfo
{
    private static LocationManager a;
    private static boolean b;
    private static double c;
    private static double d;
    private static double e;
    private static boolean f;
    private static long g;
    
    private static LocationManager a() {
        synchronized (LocationInfo.class) {
            return LocationInfo.a;
        }
    }
    
    private static void a(final double c) {
        LocationInfo.c = c;
    }
    
    private static void a(final long g) {
        LocationInfo.g = g;
    }
    
    static void a(final Location location) {
        if (location != null) {
            LocationInfo.f = true;
            LocationInfo.c = location.getLatitude();
            LocationInfo.d = location.getLongitude();
            LocationInfo.e = location.getAccuracy();
            LocationInfo.g = location.getTime();
        }
    }
    
    private static void a(final LocationManager a) {
        synchronized (LocationInfo.class) {
            LocationInfo.a = a;
        }
    }
    
    static void a(final boolean b) {
        LocationInfo.b = b;
    }
    
    private static Location b() {
        if (a() == null) {
            a((LocationManager)InternalSDKUtil.getContext().getSystemService("location"));
        }
        if (a() != null) {
            final LocationManager a = a();
            final List providers = a.getProviders(true);
            for (int i = -1 + providers.size(); i >= 0; --i) {
                final String s = providers.get(i);
                if (a.isProviderEnabled(s)) {
                    final Location lastKnownLocation = a.getLastKnownLocation(s);
                    if (lastKnownLocation != null) {
                        return lastKnownLocation;
                    }
                }
            }
        }
        return null;
    }
    
    private static void b(final double d) {
        LocationInfo.d = d;
    }
    
    static void b(final boolean f) {
        LocationInfo.f = f;
    }
    
    private static void c(final double e) {
        LocationInfo.e = e;
    }
    
    public static long getGeoTS() {
        return LocationInfo.g;
    }
    
    public static double getLat() {
        return LocationInfo.c;
    }
    
    public static double getLocAccuracy() {
        return LocationInfo.e;
    }
    
    public static double getLon() {
        return LocationInfo.d;
    }
    
    public static boolean isLocationDeniedByUser() {
        return LocationInfo.b;
    }
    
    public static boolean isValidGeoInfo() {
        return LocationInfo.f;
    }
    
    public static void updateBestKnownLocation() {
        try {
            if (a() == null) {
                a((LocationManager)InternalSDKUtil.getContext().getSystemService("location"));
            }
            if (a() != null) {
                final LocationManager a = a();
                final Criteria criteria = new Criteria();
                if (InternalSDKUtil.getContext().checkCallingOrSelfPermission("android.permission.ACCESS_FINE_LOCATION") == 0) {
                    criteria.setAccuracy(1);
                }
                else if (InternalSDKUtil.getContext().checkCallingOrSelfPermission("android.permission.ACCESS_COARSE_LOCATION") == 0) {
                    criteria.setAccuracy(2);
                }
                criteria.setCostAllowed(false);
                final String bestProvider = a.getBestProvider(criteria, true);
                if (!isValidGeoInfo() && bestProvider != null) {
                    Location location = a.getLastKnownLocation(bestProvider);
                    Log.debug("[InMobi]-4.4.3", "lastBestKnownLocation: " + location);
                    if (location == null) {
                        location = b();
                        Log.debug("[InMobi]-4.4.3", "lastKnownLocation: " + location);
                    }
                    a(location);
                }
            }
        }
        catch (Exception ex) {
            Log.debug("[InMobi]-4.4.3", "Error getting the Location Info ", ex);
        }
    }
    
    public static void verifyLocationPermission() {
        final int checkCallingOrSelfPermission = InternalSDKUtil.getContext().checkCallingOrSelfPermission("android.permission.ACCESS_COARSE_LOCATION");
        final int checkCallingOrSelfPermission2 = InternalSDKUtil.getContext().checkCallingOrSelfPermission("android.permission.ACCESS_FINE_LOCATION");
        if (checkCallingOrSelfPermission != 0 && checkCallingOrSelfPermission2 != 0) {
            LocationInfo.b = true;
            return;
        }
        LocationInfo.b = false;
    }
}
