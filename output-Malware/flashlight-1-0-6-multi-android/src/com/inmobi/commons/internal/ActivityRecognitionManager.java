// 
// Decompiled by Procyon v0.5.30
// 

package com.inmobi.commons.internal;

import com.google.android.gms.common.GooglePlayServicesUtil;
import android.os.Build$VERSION;
import android.content.Intent;
import java.lang.reflect.InvocationHandler;
import java.lang.reflect.Proxy;
import android.content.Context;
import android.app.IntentService;

public class ActivityRecognitionManager extends IntentService
{
    static Object a;
    static Object b;
    static int c;
    private static Object d;
    private static Object e;
    
    static {
        ActivityRecognitionManager.a = null;
        ActivityRecognitionManager.b = null;
        ActivityRecognitionManager.d = null;
        ActivityRecognitionManager.e = null;
        ActivityRecognitionManager.c = -1;
    }
    
    public ActivityRecognitionManager() {
        super("InMobi activity service");
    }
    
    private static void a(final Context context) {
        while (true) {
            while (true) {
                int n = 0;
                Class<?> clazz3 = null;
                Label_0282: {
                    Class<?> clazz;
                    try {
                        if (ActivityRecognitionManager.a == null) {
                            return;
                        }
                        final Class<?> forName = Class.forName("com.google.android.gms.common.GooglePlayServicesClient");
                        final Class<?> forName2 = Class.forName("com.google.android.gms.location.ActivityRecognitionClient");
                        if (ActivityRecognitionManager.b != null) {
                            forName.getMethod("disconnect", (Class<?>[])null).invoke(ActivityRecognitionManager.b, (Object[])null);
                        }
                        final Class<?>[] declaredClasses = forName.getDeclaredClasses();
                        final int length = declaredClasses.length;
                        n = 0;
                        clazz = null;
                        Class<?> clazz2 = null;
                        if (n >= length) {
                            ActivityRecognitionManager.b = forName2.getDeclaredConstructor(Context.class, clazz, clazz2).newInstance(context, ActivityRecognitionManager.d, ActivityRecognitionManager.e);
                            forName.getMethod("connect", (Class<?>[])null).invoke(ActivityRecognitionManager.b, (Object[])null);
                            return;
                        }
                        clazz3 = declaredClasses[n];
                        if (clazz3.getSimpleName().equalsIgnoreCase("ConnectionCallbacks")) {
                            ActivityRecognitionManager.d = Proxy.newProxyInstance(clazz3.getClassLoader(), new Class[] { clazz3 }, new ActivityRecognitionManager$b(null));
                            break Label_0282;
                        }
                        if (clazz3.getSimpleName().equalsIgnoreCase("OnConnectionFailedListener")) {
                            ActivityRecognitionManager.e = Proxy.newProxyInstance(clazz3.getClassLoader(), new Class[] { clazz3 }, new ActivityRecognitionManager$b(null));
                            clazz2 = clazz3;
                            clazz3 = clazz;
                            break Label_0282;
                        }
                    }
                    catch (ClassCastException ex2) {
                        Log.internal("[InMobi]-4.4.3", "Init: Google play services not included. Cannot get current activity.");
                        return;
                    }
                    catch (Exception ex) {
                        Log.internal("[InMobi]-4.4.3", "Init: Something went wrong during ActivityRecognitionManager.init", ex);
                        return;
                    }
                    clazz3 = clazz;
                }
                ++n;
                Class<?> clazz = clazz3;
                continue;
            }
        }
    }
    
    private void a(final Intent intent) {
        try {
            final Class<?> forName = Class.forName("com.google.android.gms.location.ActivityRecognitionResult");
            if (forName.getMethod("hasResult", Intent.class).invoke(null, intent)) {
                ActivityRecognitionManager.a = forName.getMethod("getMostProbableActivity", (Class<?>[])null).invoke(forName.getMethod("extractResult", Intent.class).invoke(null, intent), (Object[])null);
            }
        }
        catch (ClassNotFoundException ex) {
            Log.internal("[InMobi]-4.4.3", "HandleIntent: Google play services not included. Cannot get current activity.");
        }
        catch (Exception ex2) {
            Log.internal("[InMobi]-4.4.3", "HandleIntent: Google play services not included. Cannot get current activity.");
        }
    }
    
    private static boolean a() {
        if (Build$VERSION.SDK_INT < 8) {
            return false;
        }
        if (ActivityRecognitionManager.c != -1) {
            goto Label_0111;
        }
        try {
            ActivityRecognitionManager.a = Class.forName("com.google.android.gms.location.DetectedActivity").getConstructor(Integer.TYPE, Integer.TYPE).newInstance(-1, 100);
            ActivityRecognitionManager.c = 1;
            if (GooglePlayServicesUtil.isGooglePlayServicesAvailable(InternalSDKUtil.getContext()) != 0) {
                ActivityRecognitionManager.c = 0;
                return false;
            }
            goto Label_0111;
        }
        catch (ClassNotFoundException ex) {
            Log.debug("[InMobi]-4.4.3", "Google play services not included.");
            ActivityRecognitionManager.c = 0;
        }
        catch (Exception ex2) {
            Log.debug("[InMobi]-4.4.3", "Google play services not included.");
            ActivityRecognitionManager.c = 0;
            goto Label_0111;
        }
    }
    
    public static int getDetectedActivity() {
        try {
            if (ActivityRecognitionManager.a == null) {
                return -1;
            }
            return (int)Class.forName("com.google.android.gms.location.DetectedActivity").getMethod("getType", (Class<?>[])null).invoke(ActivityRecognitionManager.a, (Object[])null);
        }
        catch (ClassNotFoundException ex) {
            Log.internal("[InMobi]-4.4.3", "getDetectedActivity: Google play services not included. Returning null.");
            return -1;
        }
        catch (Exception ex2) {
            Log.internal("[InMobi]-4.4.3", "getDetectedActivity: Google play services not included. Returning null.");
            return -1;
        }
    }
    
    public static void init(final Context context) {
        if (a()) {
            a(context);
        }
    }
    
    protected void onHandleIntent(final Intent intent) {
        if (a()) {
            this.a(intent);
        }
    }
}
