// 
// Decompiled by Procyon v0.5.30
// 

package com.inmobi.commons.analytics.net;

import com.inmobi.commons.analytics.util.AnalyticsUtils;
import com.inmobi.commons.analytics.util.SessionInfo;
import com.inmobi.commons.analytics.db.AnalyticsDatabaseManager;
import com.inmobi.commons.internal.InternalSDKUtil;
import com.inmobi.commons.uid.UIDHelper;
import java.util.Map;
import java.util.HashMap;
import com.inmobi.commons.analytics.bootstrapper.AnalyticsInitializer;
import java.util.Random;
import com.inmobi.commons.internal.Log;
import android.os.Handler;

public final class AnalyticsNetworkManager
{
    public static final int MESSAGE_PING = 1001;
    private static Handler a;
    private static AnalyticsNetworkManager b;
    private static AnalyticsConnectivityReceiver$a f;
    private AnalyticsPayloadBuilder c;
    private AnalyticsConnectivityReceiver d;
    private int e;
    
    static {
        AnalyticsNetworkManager.f = new a();
    }
    
    private AnalyticsNetworkManager() {
        this.e = 0;
        new AnalyticsNetworkManager$a(this).start();
        Log.debug("[InMobi]-[Analytics]-4.4.3", "NetworkManager-> Constructor ");
    }
    
    private String a(final String s, final String s2, final boolean b) {
        final StringBuilder sb = new StringBuilder();
        final String string = Integer.toString(new Random().nextInt());
        final Long ltvId = AnalyticsInitializer.getConfigParams().getLTVId();
        if (s != null) {
            sb.append("payload=");
            sb.append(AnalyticsCommon.getURLEncoded(s));
        }
        if (s2 != null) {
            sb.append("&mk-siteid=");
            sb.append(s2);
        }
        sb.append("&c=");
        if (b) {
            sb.append(1);
        }
        else {
            sb.append(0);
        }
        HashMap<String, String> hashMap = null;
        if (ltvId != null) {
            hashMap = new HashMap<String, String>();
            hashMap.put("LTVID", new StringBuilder().append(ltvId).toString());
        }
        final String uidMap = AnalyticsInitializer.getConfigParams().getUID().getUidMap(1, string, hashMap);
        sb.append("&u-id-map=");
        sb.append(AnalyticsCommon.getURLEncoded(uidMap));
        sb.append("&u-id-key=");
        sb.append(string);
        sb.append("&u-key-ver=");
        sb.append(UIDHelper.getRSAKeyVersion());
        final String string2 = "pr-SAND-" + InternalSDKUtil.getInMobiInternalVersion("4.4.3") + "-20140730";
        sb.append("&mk-version=");
        sb.append(string2);
        sb.append("&u-id-adt=");
        if (InternalSDKUtil.isLimitAdTrackingEnabled()) {
            sb.append(1);
        }
        else {
            sb.append(0);
        }
        return sb.toString();
    }
    
    private void a(final AnalyticsPayload p0, final String p1) {
        // 
        // This method could not be decompiled.
        // 
        // Original Bytecode:
        // 
        //     0: ldc             "[InMobi]-[Analytics]-4.4.3"
        //     2: new             Ljava/lang/StringBuilder;
        //     5: dup            
        //     6: ldc             "Ping URL: "
        //     8: invokespecial   java/lang/StringBuilder.<init>:(Ljava/lang/String;)V
        //    11: invokestatic    com/inmobi/commons/analytics/util/AnalyticsUtils.getEventUrl:()Ljava/lang/String;
        //    14: invokevirtual   java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
        //    17: invokevirtual   java/lang/StringBuilder.toString:()Ljava/lang/String;
        //    20: invokestatic    com/inmobi/commons/internal/Log.internal:(Ljava/lang/String;Ljava/lang/String;)V
        //    23: aload_1        
        //    24: invokevirtual   com/inmobi/commons/analytics/net/AnalyticsPayload.getCompletePayload:()Ljava/lang/String;
        //    27: astore          4
        //    29: invokestatic    com/inmobi/commons/analytics/bootstrapper/AnalyticsInitializer.getConfigParams:()Lcom/inmobi/commons/analytics/bootstrapper/AnalyticsConfigParams;
        //    32: invokevirtual   com/inmobi/commons/analytics/bootstrapper/AnalyticsConfigParams.getMinEventsToCompress:()I
        //    35: istore          5
        //    37: ldc             "[InMobi]-[Analytics]-4.4.3"
        //    39: new             Ljava/lang/StringBuilder;
        //    42: dup            
        //    43: ldc             "Post body: "
        //    45: invokespecial   java/lang/StringBuilder.<init>:(Ljava/lang/String;)V
        //    48: aload           4
        //    50: invokevirtual   java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
        //    53: invokevirtual   java/lang/StringBuilder.toString:()Ljava/lang/String;
        //    56: invokestatic    com/inmobi/commons/internal/Log.internal:(Ljava/lang/String;Ljava/lang/String;)V
        //    59: aload_1        
        //    60: invokevirtual   com/inmobi/commons/analytics/net/AnalyticsPayload.getPayloadSize:()I
        //    63: iload           5
        //    65: if_icmplt       470
        //    68: getstatic       android/os/Build$VERSION.SDK_INT:I
        //    71: bipush          8
        //    73: if_icmplt       470
        //    76: ldc             "[InMobi]-[Analytics]-4.4.3"
        //    78: ldc             "Compressing the payload"
        //    80: invokestatic    com/inmobi/commons/internal/Log.debug:(Ljava/lang/String;Ljava/lang/String;)V
        //    83: iconst_1       
        //    84: istore          6
        //    86: aload           4
        //    88: invokestatic    com/inmobi/commons/analytics/util/AnalyticsUtils.compressPayload:(Ljava/lang/String;)Ljava/lang/String;
        //    91: astore          4
        //    93: invokestatic    com/inmobi/commons/analytics/bootstrapper/AnalyticsInitializer.getConfigParams:()Lcom/inmobi/commons/analytics/bootstrapper/AnalyticsConfigParams;
        //    96: invokevirtual   com/inmobi/commons/analytics/bootstrapper/AnalyticsConfigParams.getMaxAppIdLength:()I
        //    99: istore          7
        //   101: aload_2        
        //   102: invokevirtual   java/lang/String.length:()I
        //   105: iload           7
        //   107: if_icmple       118
        //   110: aload_2        
        //   111: iconst_0       
        //   112: iload           7
        //   114: invokevirtual   java/lang/String.substring:(II)Ljava/lang/String;
        //   117: astore_2       
        //   118: aload_0        
        //   119: aload           4
        //   121: aload_2        
        //   122: iload           6
        //   124: invokespecial   com/inmobi/commons/analytics/net/AnalyticsNetworkManager.a:(Ljava/lang/String;Ljava/lang/String;Z)Ljava/lang/String;
        //   127: astore          8
        //   129: ldc             "[InMobi]-[Analytics]-4.4.3"
        //   131: new             Ljava/lang/StringBuilder;
        //   134: dup            
        //   135: ldc             "Post body: "
        //   137: invokespecial   java/lang/StringBuilder.<init>:(Ljava/lang/String;)V
        //   140: aload           8
        //   142: invokevirtual   java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
        //   145: invokevirtual   java/lang/StringBuilder.toString:()Ljava/lang/String;
        //   148: invokestatic    com/inmobi/commons/internal/Log.debug:(Ljava/lang/String;Ljava/lang/String;)V
        //   151: new             Lcom/inmobi/commons/analytics/net/AnalyticsCommon;
        //   154: dup            
        //   155: invokespecial   com/inmobi/commons/analytics/net/AnalyticsCommon.<init>:()V
        //   158: astore          9
        //   160: aload           9
        //   162: invokestatic    com/inmobi/commons/analytics/util/AnalyticsUtils.getEventUrl:()Ljava/lang/String;
        //   165: invokevirtual   com/inmobi/commons/analytics/net/AnalyticsCommon.setupConnection:(Ljava/lang/String;)Ljava/net/HttpURLConnection;
        //   168: astore          10
        //   170: aload           9
        //   172: aload           10
        //   174: aload           8
        //   176: invokevirtual   com/inmobi/commons/analytics/net/AnalyticsCommon.postData:(Ljava/net/HttpURLConnection;Ljava/lang/String;)V
        //   179: aload           10
        //   181: invokevirtual   java/net/HttpURLConnection.getResponseCode:()I
        //   184: istore          21
        //   186: iload           21
        //   188: istore          12
        //   190: ldc             "[InMobi]-[Analytics]-4.4.3"
        //   192: new             Ljava/lang/StringBuilder;
        //   195: dup            
        //   196: ldc             "Http Status Code: "
        //   198: invokespecial   java/lang/StringBuilder.<init>:(Ljava/lang/String;)V
        //   201: iload           12
        //   203: invokevirtual   java/lang/StringBuilder.append:(I)Ljava/lang/StringBuilder;
        //   206: invokevirtual   java/lang/StringBuilder.toString:()Ljava/lang/String;
        //   209: invokestatic    com/inmobi/commons/internal/Log.debug:(Ljava/lang/String;Ljava/lang/String;)V
        //   212: iload           12
        //   214: sipush          200
        //   217: if_icmpne       307
        //   220: aload_0        
        //   221: iconst_0       
        //   222: putfield        com/inmobi/commons/analytics/net/AnalyticsNetworkManager.e:I
        //   225: invokestatic    com/inmobi/commons/analytics/db/AnalyticsDatabaseManager.getInstance:()Lcom/inmobi/commons/analytics/db/AnalyticsDatabaseManager;
        //   228: aload_1        
        //   229: invokevirtual   com/inmobi/commons/analytics/net/AnalyticsPayload.getTableIdList:()Ljava/util/List;
        //   232: invokevirtual   com/inmobi/commons/analytics/db/AnalyticsDatabaseManager.deleteEvents:(Ljava/util/List;)V
        //   235: new             Ljava/io/BufferedReader;
        //   238: dup            
        //   239: new             Ljava/io/InputStreamReader;
        //   242: dup            
        //   243: aload           10
        //   245: invokevirtual   java/net/HttpURLConnection.getInputStream:()Ljava/io/InputStream;
        //   248: ldc             "UTF-8"
        //   250: invokespecial   java/io/InputStreamReader.<init>:(Ljava/io/InputStream;Ljava/lang/String;)V
        //   253: invokespecial   java/io/BufferedReader.<init>:(Ljava/io/Reader;)V
        //   256: astore          13
        //   258: new             Ljava/lang/StringBuilder;
        //   261: dup            
        //   262: invokespecial   java/lang/StringBuilder.<init>:()V
        //   265: astore          14
        //   267: aload           13
        //   269: invokevirtual   java/io/BufferedReader.readLine:()Ljava/lang/String;
        //   272: astore          16
        //   274: aload           16
        //   276: ifnull          427
        //   279: aload           14
        //   281: aload           16
        //   283: invokevirtual   java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
        //   286: ldc_w           "\n"
        //   289: invokevirtual   java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
        //   292: pop            
        //   293: goto            267
        //   296: astore          15
        //   298: ldc             "[InMobi]-[Analytics]-4.4.3"
        //   300: ldc_w           "Unable to read from stream"
        //   303: invokestatic    com/inmobi/commons/internal/Log.internal:(Ljava/lang/String;Ljava/lang/String;)V
        //   306: return         
        //   307: aload_0        
        //   308: iconst_1       
        //   309: aload_0        
        //   310: getfield        com/inmobi/commons/analytics/net/AnalyticsNetworkManager.e:I
        //   313: iadd           
        //   314: putfield        com/inmobi/commons/analytics/net/AnalyticsNetworkManager.e:I
        //   317: aload_0        
        //   318: getfield        com/inmobi/commons/analytics/net/AnalyticsNetworkManager.e:I
        //   321: invokestatic    com/inmobi/commons/analytics/util/AnalyticsUtils.getMaxRetryBeforeDiscard:()I
        //   324: if_icmplt       235
        //   327: aload_0        
        //   328: iconst_0       
        //   329: putfield        com/inmobi/commons/analytics/net/AnalyticsNetworkManager.e:I
        //   332: invokestatic    com/inmobi/commons/analytics/db/AnalyticsDatabaseManager.getInstance:()Lcom/inmobi/commons/analytics/db/AnalyticsDatabaseManager;
        //   335: aload_1        
        //   336: invokevirtual   com/inmobi/commons/analytics/net/AnalyticsPayload.getTableIdList:()Ljava/util/List;
        //   339: invokevirtual   com/inmobi/commons/analytics/db/AnalyticsDatabaseManager.deleteEvents:(Ljava/util/List;)V
        //   342: goto            235
        //   345: astore_3       
        //   346: ldc             "[InMobi]-[Analytics]-4.4.3"
        //   348: ldc_w           "Exception Pinging"
        //   351: aload_3        
        //   352: invokestatic    com/inmobi/commons/internal/Log.debug:(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)V
        //   355: aload_0        
        //   356: iconst_1       
        //   357: aload_0        
        //   358: getfield        com/inmobi/commons/analytics/net/AnalyticsNetworkManager.e:I
        //   361: iadd           
        //   362: putfield        com/inmobi/commons/analytics/net/AnalyticsNetworkManager.e:I
        //   365: aload_0        
        //   366: getfield        com/inmobi/commons/analytics/net/AnalyticsNetworkManager.e:I
        //   369: invokestatic    com/inmobi/commons/analytics/util/AnalyticsUtils.getMaxRetryBeforeDiscard:()I
        //   372: if_icmplt       476
        //   375: aload_0        
        //   376: iconst_0       
        //   377: putfield        com/inmobi/commons/analytics/net/AnalyticsNetworkManager.e:I
        //   380: invokestatic    com/inmobi/commons/analytics/db/AnalyticsDatabaseManager.getInstance:()Lcom/inmobi/commons/analytics/db/AnalyticsDatabaseManager;
        //   383: aload_1        
        //   384: invokevirtual   com/inmobi/commons/analytics/net/AnalyticsPayload.getTableIdList:()Ljava/util/List;
        //   387: invokevirtual   com/inmobi/commons/analytics/db/AnalyticsDatabaseManager.deleteEvents:(Ljava/util/List;)V
        //   390: return         
        //   391: astore          19
        //   393: new             Ljava/io/BufferedReader;
        //   396: dup            
        //   397: new             Ljava/io/InputStreamReader;
        //   400: dup            
        //   401: aload           10
        //   403: invokevirtual   java/net/HttpURLConnection.getErrorStream:()Ljava/io/InputStream;
        //   406: ldc             "UTF-8"
        //   408: invokespecial   java/io/InputStreamReader.<init>:(Ljava/io/InputStream;Ljava/lang/String;)V
        //   411: invokespecial   java/io/BufferedReader.<init>:(Ljava/io/Reader;)V
        //   414: astore          13
        //   416: goto            258
        //   419: astore          20
        //   421: aconst_null    
        //   422: astore          13
        //   424: goto            258
        //   427: aload           14
        //   429: invokevirtual   java/lang/StringBuilder.toString:()Ljava/lang/String;
        //   432: astore          18
        //   434: ldc             "[InMobi]-[Analytics]-4.4.3"
        //   436: new             Ljava/lang/StringBuilder;
        //   439: dup            
        //   440: ldc_w           "Ping Response: "
        //   443: invokespecial   java/lang/StringBuilder.<init>:(Ljava/lang/String;)V
        //   446: aload           18
        //   448: invokevirtual   java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
        //   451: invokevirtual   java/lang/StringBuilder.toString:()Ljava/lang/String;
        //   454: invokestatic    com/inmobi/commons/internal/Log.debug:(Ljava/lang/String;Ljava/lang/String;)V
        //   457: aload           10
        //   459: invokevirtual   java/net/HttpURLConnection.disconnect:()V
        //   462: aload           9
        //   464: aload           13
        //   466: invokevirtual   com/inmobi/commons/analytics/net/AnalyticsCommon.closeResource:(Ljava/io/Closeable;)V
        //   469: return         
        //   470: iconst_0       
        //   471: istore          6
        //   473: goto            93
        //   476: return         
        //   477: astore          11
        //   479: sipush          401
        //   482: istore          12
        //   484: goto            190
        //    Exceptions:
        //  Try           Handler
        //  Start  End    Start  End    Type                 
        //  -----  -----  -----  -----  ---------------------
        //  0      83     345    391    Ljava/lang/Exception;
        //  86     93     345    391    Ljava/lang/Exception;
        //  93     118    345    391    Ljava/lang/Exception;
        //  118    179    345    391    Ljava/lang/Exception;
        //  179    186    477    487    Ljava/io/IOException;
        //  179    186    345    391    Ljava/lang/Exception;
        //  190    212    345    391    Ljava/lang/Exception;
        //  220    235    345    391    Ljava/lang/Exception;
        //  235    258    391    427    Ljava/lang/Exception;
        //  258    267    296    307    Ljava/lang/Exception;
        //  267    274    296    307    Ljava/lang/Exception;
        //  279    293    296    307    Ljava/lang/Exception;
        //  298    306    345    391    Ljava/lang/Exception;
        //  307    342    345    391    Ljava/lang/Exception;
        //  393    416    419    427    Ljava/lang/Exception;
        //  427    469    296    307    Ljava/lang/Exception;
        // 
        // The error that occurred was:
        // 
        // java.lang.IllegalStateException: Expression is linked from several locations: Label_0190:
        //     at com.strobel.decompiler.ast.Error.expressionLinkedFromMultipleLocations(Error.java:27)
        //     at com.strobel.decompiler.ast.AstOptimizer.mergeDisparateObjectInitializations(AstOptimizer.java:2592)
        //     at com.strobel.decompiler.ast.AstOptimizer.optimize(AstOptimizer.java:235)
        //     at com.strobel.decompiler.ast.AstOptimizer.optimize(AstOptimizer.java:42)
        //     at com.strobel.decompiler.languages.java.ast.AstMethodBodyBuilder.createMethodBody(AstMethodBodyBuilder.java:214)
        //     at com.strobel.decompiler.languages.java.ast.AstMethodBodyBuilder.createMethodBody(AstMethodBodyBuilder.java:99)
        //     at com.strobel.decompiler.languages.java.ast.AstBuilder.createMethodBody(AstBuilder.java:757)
        //     at com.strobel.decompiler.languages.java.ast.AstBuilder.createMethod(AstBuilder.java:655)
        //     at com.strobel.decompiler.languages.java.ast.AstBuilder.addTypeMembers(AstBuilder.java:532)
        //     at com.strobel.decompiler.languages.java.ast.AstBuilder.createTypeCore(AstBuilder.java:499)
        //     at com.strobel.decompiler.languages.java.ast.AstBuilder.createTypeNoCache(AstBuilder.java:141)
        //     at com.strobel.decompiler.languages.java.ast.AstBuilder.createType(AstBuilder.java:130)
        //     at com.strobel.decompiler.languages.java.ast.AstBuilder.addType(AstBuilder.java:105)
        //     at com.strobel.decompiler.languages.java.JavaLanguage.buildAst(JavaLanguage.java:71)
        //     at com.strobel.decompiler.languages.java.JavaLanguage.decompileType(JavaLanguage.java:59)
        //     at com.strobel.decompiler.DecompilerDriver.decompileType(DecompilerDriver.java:317)
        //     at com.strobel.decompiler.DecompilerDriver.decompileJar(DecompilerDriver.java:238)
        //     at com.strobel.decompiler.DecompilerDriver.main(DecompilerDriver.java:123)
        // 
        throw new IllegalStateException("An error occurred while decompiling this method.");
    }
    
    private void b() {
        boolean b = true;
        if (this.d != null && this.d.isConnected() && this.c != null) {
            final AnalyticsPayload payloadList = this.c.getPayloadList(AnalyticsDatabaseManager.getInstance().getEvents(), InternalSDKUtil.getContext());
            if (payloadList.getCompletePayload() != null) {
                this.a(payloadList, SessionInfo.getAppId(InternalSDKUtil.getContext()));
                b = false;
            }
        }
        if (!b) {
            AnalyticsNetworkManager.a.sendEmptyMessageDelayed(1001, AnalyticsUtils.getTimeinterval());
            return;
        }
        AnalyticsUtils.setStartHandle(false);
    }
    
    public static Handler getHandler() {
        return AnalyticsNetworkManager.a;
    }
    
    public static AnalyticsNetworkManager startInstance() {
        synchronized (AnalyticsNetworkManager.class) {
            if (AnalyticsNetworkManager.b == null) {
                AnalyticsNetworkManager.b = new AnalyticsNetworkManager();
            }
            if (AnalyticsNetworkManager.b.c == null) {
                AnalyticsNetworkManager.b.c = new AnalyticsPayloadBuilder();
            }
            if (AnalyticsNetworkManager.b.d == null) {
                AnalyticsNetworkManager.b.d = new AnalyticsConnectivityReceiver(InternalSDKUtil.getContext(), AnalyticsNetworkManager.f);
            }
            return AnalyticsNetworkManager.b;
        }
    }
}
