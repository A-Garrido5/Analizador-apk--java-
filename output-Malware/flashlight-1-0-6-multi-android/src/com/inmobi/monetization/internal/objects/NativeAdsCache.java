// 
// Decompiled by Procyon v0.5.30
// 

package com.inmobi.monetization.internal.objects;

import com.inmobi.commons.ads.cache.AdData;
import java.util.List;
import com.inmobi.commons.internal.Log;
import android.util.Base64;
import org.json.JSONObject;
import com.inmobi.monetization.IMNative;
import com.inmobi.androidsdk.bootstrapper.Initializer;
import com.inmobi.commons.ads.cache.AdDatabaseManager;
import com.inmobi.commons.internal.InternalSDKUtil;
import android.content.Context;

public class NativeAdsCache
{
    static NativeAdsCache a;
    
    private NativeAdsCache(final Context context) {
    }
    
    public static NativeAdsCache getInstance() {
        Label_0025: {
            if (NativeAdsCache.a != null) {
                break Label_0025;
            }
            synchronized (NativeAdsCache.class) {
                NativeAdsCache.a = new NativeAdsCache(InternalSDKUtil.getContext());
                // monitorexit(NativeAdsCache.class)
                AdDatabaseManager.getInstance().setDBLimit(Initializer.getConfigParams().getNativeSdkConfigParams().getmMaxCacheSize());
                return NativeAdsCache.a;
            }
        }
    }
    
    public IMNative getCachedAd(final String s) {
        try {
            final JSONObject jsonObject = new JSONObject(AdDatabaseManager.getInstance().getAd(s).getContent());
            return new NativeAd(new String(Base64.decode(jsonObject.getString("pubContent"), 0)).trim(), jsonObject.getString("contextCode"), jsonObject.getString("namespace"));
        }
        catch (Exception ex) {
            Log.internal("[InMobi]-[Monetization]", "Exception getting cached ad", ex);
            return null;
        }
    }
    
    public int getNumCachedAds(final String s) {
        try {
            return AdDatabaseManager.getInstance().getNoOfAds(s);
        }
        catch (Exception ex) {
            return 0;
        }
    }
    
    public void saveNativeAds(final String appId, final List list) {
        if (list != null && list.size() > 0) {
            for (int i = 0; i < list.size(); ++i) {
                final AdData adData = new AdData();
                adData.setContent(list.get(i));
                adData.setTimestamp(System.currentTimeMillis());
                adData.setAppId(appId);
                adData.setAdType("native");
                AdDatabaseManager.getInstance().insertAd(adData);
            }
        }
    }
}
