// 
// Decompiled by Procyon v0.5.30
// 

package com.nexage.android;

import java.util.Iterator;
import com.nexage.android.internal.NexageLog;
import android.location.Location;
import android.content.Context;
import android.location.LocationManager;

public class DefaultDeviceLocationImplementation implements DeviceLocation
{
    public static final int LOC_PRECISION = 4;
    LocationManager locationManager;
    
    public DefaultDeviceLocationImplementation(final Context context) {
        this.locationManager = (LocationManager)context.getSystemService("location");
    }
    
    @Override
    public Location getLocation() {
        NexageLog.d("getCoordinates start");
        final Iterator<String> iterator = (Iterator<String>)this.locationManager.getAllProviders().iterator();
        float n = Float.MAX_VALUE;
        Location location = null;
        long n2 = Long.MIN_VALUE;
    Label_0206_Outer:
        while (iterator.hasNext()) {
            final String s = iterator.next();
            if (!s.equals("gps")) {
                s.equals("passive");
            }
            final Location lastKnownLocation = this.locationManager.getLastKnownLocation(s);
            while (true) {
                Label_0218: {
                    if (lastKnownLocation == null) {
                        break Label_0218;
                    }
                    final float accuracy = lastKnownLocation.getAccuracy();
                    long time = lastKnownLocation.getTime();
                    if (time > System.currentTimeMillis() && s.equals("gps")) {
                        time -= 86400000L;
                    }
                    if (accuracy < n) {
                        NexageLog.d("getCoordinates 1: " + s);
                        n2 = time;
                        n = accuracy;
                        location = lastKnownLocation;
                        continue Label_0206_Outer;
                    }
                    if (n != Float.MAX_VALUE || time <= n2) {
                        break Label_0218;
                    }
                    NexageLog.d("getCoordinates 2: " + s);
                    final long n3 = time;
                    final Location location2 = lastKnownLocation;
                    location = location2;
                    n2 = n3;
                    continue Label_0206_Outer;
                }
                final long n3 = n2;
                final Location location2 = location;
                continue;
            }
        }
        return location;
    }
}
