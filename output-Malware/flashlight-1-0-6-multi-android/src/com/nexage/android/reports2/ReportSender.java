// 
// Decompiled by Procyon v0.5.30
// 

package com.nexage.android.reports2;

import org.json.JSONException;
import java.util.TimerTask;
import java.util.Timer;
import android.text.TextUtils;
import com.nexage.android.internal.GooglePlayServiceManager;
import com.nexage.android.internal.HttpUtils;
import java.util.regex.Matcher;
import java.util.Hashtable;
import java.util.regex.Pattern;
import com.nexage.android.NexageAdManager;
import com.nexage.android.internal.NexageLog;
import android.content.Context;
import com.nexage.android.internal.TRUSTeManager;
import com.nexage.android.internal.TRUSTeManager$Listener;

class ReportSender
{
    static final String TAG = "ReportSender";
    private static StringBuilder paramsBuilder;
    static AdReport2 report;
    static String reportJson;
    static int totalClicks;
    static int totalDisplays;
    static int totalReqs;
    private static TRUSTeManager$Listener trusteListener;
    private static TRUSTeManager trusteManager;
    
    private static void addImpressionGroupsToReport() {
        NexageLog.d("ReportSender", "addImpressionGroupsToReport");
        final Hashtable impressionsGroups = NexageAdManager.getImpressionsGroups();
        if (impressionsGroups == null || impressionsGroups.size() == 0) {
            NexageLog.d("ReportSender", "no impression groups found");
            return;
        }
        NexageLog.d("ReportSender", "adding impression groups...");
        final StringBuffer sb = new StringBuffer(ReportSender.reportJson);
        final Pattern compile = Pattern.compile("\"zone\":\"([^\"]+)\"");
        Matcher matcher = compile.matcher(sb);
        int end;
        Matcher matcher2;
        for (int n = 0; matcher.find(n); matcher = matcher2, n = end) {
            final String group = matcher.group(0);
            final String group2 = matcher.group(1);
            final int start = matcher.start();
            end = matcher.end();
            final String s = impressionsGroups.get(group2);
            if (s != null) {
                sb.replace(start, end, group + ",\"grp\":\"" + s + "\"");
                matcher2 = compile.matcher(sb);
            }
            else {
                matcher2 = matcher;
            }
        }
        ReportSender.reportJson = sb.toString();
    }
    
    private static void buildParams(final Context context) {
        (ReportSender.paramsBuilder = HttpUtils.getNexageRequestParams()).append("&data=").append(ReportSender.reportJson);
        ReportSender.paramsBuilder.append("&vr=2");
        final String id = GooglePlayServiceManager.getId(context);
        if (!TextUtils.isEmpty((CharSequence)id)) {
            final boolean limitAdTrackingEnabled = GooglePlayServiceManager.isLimitAdTrackingEnabled(context);
            ReportSender.paramsBuilder.append("&d(id24)=").append(id);
            final StringBuilder append = ReportSender.paramsBuilder.append("&ifatrk=");
            String s;
            if (limitAdTrackingEnabled) {
                s = "0";
            }
            else {
                s = "1";
            }
            append.append(s);
        }
        ReportSender.trusteManager = TRUSTeManager.getInstance(context);
        if (ReportSender.trusteListener == null) {
            ReportSender.trusteListener = new TRUSTeManager$Listener() {
                @Override
                public final void onFailedToReceiveTPID() {
                    NexageLog.d("ReportSender", "onFailedToReceiveTPID");
                    ReportSender.trusteManager.removeListener(ReportSender.trusteListener);
                    new Thread(new Runnable() {
                        @Override
                        public void run() {
                            doHttpConnection(ReportSender.paramsBuilder.toString());
                        }
                    }, "RuleMgrHTTPConn").start();
                }
                
                @Override
                public final void onReceiveTPID(final String s) {
                    NexageLog.d("ReportSender", "onReceiveTPID " + s);
                    if (!TextUtils.isEmpty((CharSequence)s)) {
                        NexageLog.v("TPID: " + s);
                        ReportSender.paramsBuilder.append("&d(tpid)=").append(s);
                    }
                    ReportSender.trusteManager.removeListener(ReportSender.trusteListener);
                    new Thread(new Runnable() {
                        @Override
                        public void run() {
                            doHttpConnection(ReportSender.paramsBuilder.toString());
                        }
                    }, "RuleMgrHTTPConn").start();
                }
            };
        }
        ReportSender.trusteManager.addListener(ReportSender.trusteListener);
        ReportSender.trusteManager.getTRUSTeTPID();
    }
    
    private static void doHttpConnection(final String p0) {
        // 
        // This method could not be decompiled.
        // 
        // Original Bytecode:
        // 
        //     0: ldc             "ReportSender"
        //     2: ldc             "doHttpConnection"
        //     4: invokestatic    com/nexage/android/internal/NexageLog.d:(Ljava/lang/String;Ljava/lang/String;)V
        //     7: ldc             "ReportSender"
        //     9: new             Ljava/lang/StringBuilder;
        //    12: dup            
        //    13: ldc             "params: "
        //    15: invokespecial   java/lang/StringBuilder.<init>:(Ljava/lang/String;)V
        //    18: aload_0        
        //    19: invokevirtual   java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
        //    22: invokevirtual   java/lang/StringBuilder.toString:()Ljava/lang/String;
        //    25: invokestatic    com/nexage/android/internal/NexageLog.d:(Ljava/lang/String;Ljava/lang/String;)V
        //    28: invokestatic    com/nexage/android/reports2/ReportManager.getReportServlet:()Ljava/lang/String;
        //    31: astore_1       
        //    32: aconst_null    
        //    33: astore_2       
        //    34: aconst_null    
        //    35: astore_3       
        //    36: iconst_m1      
        //    37: istore          4
        //    39: ldc             "ReportSender"
        //    41: ldc             "open URL connection"
        //    43: invokestatic    com/nexage/android/internal/NexageLog.d:(Ljava/lang/String;Ljava/lang/String;)V
        //    46: new             Ljava/net/URL;
        //    49: dup            
        //    50: aload_1        
        //    51: invokespecial   java/net/URL.<init>:(Ljava/lang/String;)V
        //    54: astore          28
        //    56: iconst_1       
        //    57: invokestatic    java/net/HttpURLConnection.setFollowRedirects:(Z)V
        //    60: aload           28
        //    62: invokevirtual   java/net/URL.openConnection:()Ljava/net/URLConnection;
        //    65: checkcast       Ljava/net/HttpURLConnection;
        //    68: astore          29
        //    70: aload           29
        //    72: sipush          30000
        //    75: invokevirtual   java/net/HttpURLConnection.setConnectTimeout:(I)V
        //    78: aload           29
        //    80: sipush          30000
        //    83: invokevirtual   java/net/HttpURLConnection.setReadTimeout:(I)V
        //    86: aload           29
        //    88: iconst_1       
        //    89: invokevirtual   java/net/HttpURLConnection.setDoOutput:(Z)V
        //    92: aload           29
        //    94: ldc             "Connection"
        //    96: ldc             "close"
        //    98: invokevirtual   java/net/HttpURLConnection.setRequestProperty:(Ljava/lang/String;Ljava/lang/String;)V
        //   101: aload           29
        //   103: ldc             "Content-Type"
        //   105: ldc             "application/x-www-form-urlencoded; charset=utf-8"
        //   107: invokevirtual   java/net/HttpURLConnection.setRequestProperty:(Ljava/lang/String;Ljava/lang/String;)V
        //   110: aload           29
        //   112: ldc             "POST"
        //   114: invokevirtual   java/net/HttpURLConnection.setRequestMethod:(Ljava/lang/String;)V
        //   117: getstatic       com/nexage/android/internal/NexageContext.s_UserAgent:Ljava/lang/String;
        //   120: astore          32
        //   122: aconst_null    
        //   123: astore_3       
        //   124: aload           32
        //   126: ifnull          148
        //   129: getstatic       com/nexage/android/internal/NexageContext.s_UserAgent:Ljava/lang/String;
        //   132: invokevirtual   java/lang/String.length:()I
        //   135: ifle            148
        //   138: aload           29
        //   140: ldc             "User-Agent"
        //   142: getstatic       com/nexage/android/internal/NexageContext.s_UserAgent:Ljava/lang/String;
        //   145: invokevirtual   java/net/HttpURLConnection.setRequestProperty:(Ljava/lang/String;Ljava/lang/String;)V
        //   148: aload           29
        //   150: invokestatic    com/nexage/android/internal/HttpUtils.setCookies:(Ljava/net/HttpURLConnection;)V
        //   153: aload           29
        //   155: invokevirtual   java/net/HttpURLConnection.getOutputStream:()Ljava/io/OutputStream;
        //   158: astore          33
        //   160: aload           33
        //   162: astore_3       
        //   163: aload_3        
        //   164: aload_0        
        //   165: invokevirtual   java/lang/String.toString:()Ljava/lang/String;
        //   168: ldc             "UTF-8"
        //   170: invokevirtual   java/lang/String.getBytes:(Ljava/lang/String;)[B
        //   173: invokevirtual   java/io/OutputStream.write:([B)V
        //   176: aload           29
        //   178: ldc             "ReportSender"
        //   180: invokestatic    com/nexage/android/internal/HttpUtils.saveCookies:(Ljava/net/HttpURLConnection;Ljava/lang/String;)V
        //   183: aload           29
        //   185: invokevirtual   java/net/HttpURLConnection.getResponseCode:()I
        //   188: istore          4
        //   190: ldc             "ReportSender"
        //   192: new             Ljava/lang/StringBuilder;
        //   195: dup            
        //   196: ldc_w           "Report upload status = "
        //   199: invokespecial   java/lang/StringBuilder.<init>:(Ljava/lang/String;)V
        //   202: iload           4
        //   204: invokevirtual   java/lang/StringBuilder.append:(I)Ljava/lang/StringBuilder;
        //   207: invokevirtual   java/lang/StringBuilder.toString:()Ljava/lang/String;
        //   210: invokestatic    com/nexage/android/internal/NexageLog.i:(Ljava/lang/String;Ljava/lang/String;)V
        //   213: iload           4
        //   215: sipush          200
        //   218: if_icmpeq       229
        //   221: iload           4
        //   223: sipush          201
        //   226: if_icmpne       1002
        //   229: ldc             "ReportSender"
        //   231: new             Ljava/lang/StringBuilder;
        //   234: dup            
        //   235: ldc_w           "sent this time: reqs:"
        //   238: invokespecial   java/lang/StringBuilder.<init>:(Ljava/lang/String;)V
        //   241: getstatic       com/nexage/android/reports2/ReportSender.report:Lcom/nexage/android/reports2/AdReport2;
        //   244: getfield        com/nexage/android/reports2/AdReport2.reqs:Ljava/util/ArrayList;
        //   247: invokevirtual   java/util/ArrayList.size:()I
        //   250: invokevirtual   java/lang/StringBuilder.append:(I)Ljava/lang/StringBuilder;
        //   253: ldc_w           " disp:"
        //   256: invokevirtual   java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
        //   259: getstatic       com/nexage/android/reports2/ReportSender.report:Lcom/nexage/android/reports2/AdReport2;
        //   262: getfield        com/nexage/android/reports2/AdReport2.displays:Ljava/util/ArrayList;
        //   265: invokevirtual   java/util/ArrayList.size:()I
        //   268: invokevirtual   java/lang/StringBuilder.append:(I)Ljava/lang/StringBuilder;
        //   271: ldc_w           " clicks:"
        //   274: invokevirtual   java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
        //   277: getstatic       com/nexage/android/reports2/ReportSender.report:Lcom/nexage/android/reports2/AdReport2;
        //   280: getfield        com/nexage/android/reports2/AdReport2.clicks:Ljava/util/ArrayList;
        //   283: invokevirtual   java/util/ArrayList.size:()I
        //   286: invokevirtual   java/lang/StringBuilder.append:(I)Ljava/lang/StringBuilder;
        //   289: invokevirtual   java/lang/StringBuilder.toString:()Ljava/lang/String;
        //   292: invokestatic    com/nexage/android/internal/NexageLog.i:(Ljava/lang/String;Ljava/lang/String;)V
        //   295: getstatic       com/nexage/android/reports2/ReportSender.totalReqs:I
        //   298: getstatic       com/nexage/android/reports2/ReportSender.report:Lcom/nexage/android/reports2/AdReport2;
        //   301: getfield        com/nexage/android/reports2/AdReport2.reqs:Ljava/util/ArrayList;
        //   304: invokevirtual   java/util/ArrayList.size:()I
        //   307: iadd           
        //   308: putstatic       com/nexage/android/reports2/ReportSender.totalReqs:I
        //   311: getstatic       com/nexage/android/reports2/ReportSender.totalDisplays:I
        //   314: getstatic       com/nexage/android/reports2/ReportSender.report:Lcom/nexage/android/reports2/AdReport2;
        //   317: getfield        com/nexage/android/reports2/AdReport2.displays:Ljava/util/ArrayList;
        //   320: invokevirtual   java/util/ArrayList.size:()I
        //   323: iadd           
        //   324: putstatic       com/nexage/android/reports2/ReportSender.totalDisplays:I
        //   327: getstatic       com/nexage/android/reports2/ReportSender.totalClicks:I
        //   330: getstatic       com/nexage/android/reports2/ReportSender.report:Lcom/nexage/android/reports2/AdReport2;
        //   333: getfield        com/nexage/android/reports2/AdReport2.clicks:Ljava/util/ArrayList;
        //   336: invokevirtual   java/util/ArrayList.size:()I
        //   339: iadd           
        //   340: putstatic       com/nexage/android/reports2/ReportSender.totalClicks:I
        //   343: iconst_1       
        //   344: istore          40
        //   346: iload           40
        //   348: invokestatic    com/nexage/android/reports2/ReportManager.reportFlushFinished:(Z)V
        //   351: aload_3        
        //   352: ifnull          367
        //   355: aload_3        
        //   356: invokevirtual   java/io/OutputStream.close:()V
        //   359: ldc             "ReportSender"
        //   361: ldc_w           "close out"
        //   364: invokestatic    com/nexage/android/internal/NexageLog.d:(Ljava/lang/String;Ljava/lang/String;)V
        //   367: aload           29
        //   369: ifnull          385
        //   372: aload           29
        //   374: invokevirtual   java/net/HttpURLConnection.disconnect:()V
        //   377: ldc             "ReportSender"
        //   379: ldc_w           "disconnect connection"
        //   382: invokestatic    com/nexage/android/internal/NexageLog.d:(Ljava/lang/String;Ljava/lang/String;)V
        //   385: return         
        //   386: astore          14
        //   388: iload           4
        //   390: istore          15
        //   392: aconst_null    
        //   393: astore          16
        //   395: aconst_null    
        //   396: astore          17
        //   398: iload           15
        //   400: istore          18
        //   402: ldc             "ReportSender"
        //   404: new             Ljava/lang/StringBuilder;
        //   407: dup            
        //   408: ldc_w           "Report upload exception: "
        //   411: invokespecial   java/lang/StringBuilder.<init>:(Ljava/lang/String;)V
        //   414: aload           14
        //   416: invokevirtual   java/lang/Exception.getMessage:()Ljava/lang/String;
        //   419: invokevirtual   java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
        //   422: ldc_w           ":"
        //   425: invokevirtual   java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
        //   428: aload           14
        //   430: invokevirtual   java/lang/Exception.toString:()Ljava/lang/String;
        //   433: invokevirtual   java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
        //   436: invokevirtual   java/lang/StringBuilder.toString:()Ljava/lang/String;
        //   439: invokestatic    com/nexage/android/internal/NexageLog.i:(Ljava/lang/String;Ljava/lang/String;)V
        //   442: iload           18
        //   444: sipush          200
        //   447: if_icmpeq       458
        //   450: iload           18
        //   452: sipush          201
        //   455: if_icmpne       898
        //   458: ldc             "ReportSender"
        //   460: new             Ljava/lang/StringBuilder;
        //   463: dup            
        //   464: ldc_w           "sent this time: reqs:"
        //   467: invokespecial   java/lang/StringBuilder.<init>:(Ljava/lang/String;)V
        //   470: getstatic       com/nexage/android/reports2/ReportSender.report:Lcom/nexage/android/reports2/AdReport2;
        //   473: getfield        com/nexage/android/reports2/AdReport2.reqs:Ljava/util/ArrayList;
        //   476: invokevirtual   java/util/ArrayList.size:()I
        //   479: invokevirtual   java/lang/StringBuilder.append:(I)Ljava/lang/StringBuilder;
        //   482: ldc_w           " disp:"
        //   485: invokevirtual   java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
        //   488: getstatic       com/nexage/android/reports2/ReportSender.report:Lcom/nexage/android/reports2/AdReport2;
        //   491: getfield        com/nexage/android/reports2/AdReport2.displays:Ljava/util/ArrayList;
        //   494: invokevirtual   java/util/ArrayList.size:()I
        //   497: invokevirtual   java/lang/StringBuilder.append:(I)Ljava/lang/StringBuilder;
        //   500: ldc_w           " clicks:"
        //   503: invokevirtual   java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
        //   506: getstatic       com/nexage/android/reports2/ReportSender.report:Lcom/nexage/android/reports2/AdReport2;
        //   509: getfield        com/nexage/android/reports2/AdReport2.clicks:Ljava/util/ArrayList;
        //   512: invokevirtual   java/util/ArrayList.size:()I
        //   515: invokevirtual   java/lang/StringBuilder.append:(I)Ljava/lang/StringBuilder;
        //   518: invokevirtual   java/lang/StringBuilder.toString:()Ljava/lang/String;
        //   521: invokestatic    com/nexage/android/internal/NexageLog.i:(Ljava/lang/String;Ljava/lang/String;)V
        //   524: getstatic       com/nexage/android/reports2/ReportSender.totalReqs:I
        //   527: getstatic       com/nexage/android/reports2/ReportSender.report:Lcom/nexage/android/reports2/AdReport2;
        //   530: getfield        com/nexage/android/reports2/AdReport2.reqs:Ljava/util/ArrayList;
        //   533: invokevirtual   java/util/ArrayList.size:()I
        //   536: iadd           
        //   537: putstatic       com/nexage/android/reports2/ReportSender.totalReqs:I
        //   540: getstatic       com/nexage/android/reports2/ReportSender.totalDisplays:I
        //   543: getstatic       com/nexage/android/reports2/ReportSender.report:Lcom/nexage/android/reports2/AdReport2;
        //   546: getfield        com/nexage/android/reports2/AdReport2.displays:Ljava/util/ArrayList;
        //   549: invokevirtual   java/util/ArrayList.size:()I
        //   552: iadd           
        //   553: putstatic       com/nexage/android/reports2/ReportSender.totalDisplays:I
        //   556: getstatic       com/nexage/android/reports2/ReportSender.totalClicks:I
        //   559: getstatic       com/nexage/android/reports2/ReportSender.report:Lcom/nexage/android/reports2/AdReport2;
        //   562: getfield        com/nexage/android/reports2/AdReport2.clicks:Ljava/util/ArrayList;
        //   565: invokevirtual   java/util/ArrayList.size:()I
        //   568: iadd           
        //   569: putstatic       com/nexage/android/reports2/ReportSender.totalClicks:I
        //   572: iconst_1       
        //   573: istore          26
        //   575: iload           26
        //   577: invokestatic    com/nexage/android/reports2/ReportManager.reportFlushFinished:(Z)V
        //   580: aload           16
        //   582: ifnull          598
        //   585: aload           16
        //   587: invokevirtual   java/io/OutputStream.close:()V
        //   590: ldc             "ReportSender"
        //   592: ldc_w           "close out"
        //   595: invokestatic    com/nexage/android/internal/NexageLog.d:(Ljava/lang/String;Ljava/lang/String;)V
        //   598: aload           17
        //   600: ifnull          385
        //   603: aload           17
        //   605: invokevirtual   java/net/HttpURLConnection.disconnect:()V
        //   608: ldc             "ReportSender"
        //   610: ldc_w           "disconnect connection"
        //   613: invokestatic    com/nexage/android/internal/NexageLog.d:(Ljava/lang/String;Ljava/lang/String;)V
        //   616: return         
        //   617: astore          24
        //   619: return         
        //   620: astore          5
        //   622: iload           4
        //   624: sipush          200
        //   627: if_icmpeq       638
        //   630: iload           4
        //   632: sipush          201
        //   635: if_icmpne       795
        //   638: ldc             "ReportSender"
        //   640: new             Ljava/lang/StringBuilder;
        //   643: dup            
        //   644: ldc_w           "sent this time: reqs:"
        //   647: invokespecial   java/lang/StringBuilder.<init>:(Ljava/lang/String;)V
        //   650: getstatic       com/nexage/android/reports2/ReportSender.report:Lcom/nexage/android/reports2/AdReport2;
        //   653: getfield        com/nexage/android/reports2/AdReport2.reqs:Ljava/util/ArrayList;
        //   656: invokevirtual   java/util/ArrayList.size:()I
        //   659: invokevirtual   java/lang/StringBuilder.append:(I)Ljava/lang/StringBuilder;
        //   662: ldc_w           " disp:"
        //   665: invokevirtual   java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
        //   668: getstatic       com/nexage/android/reports2/ReportSender.report:Lcom/nexage/android/reports2/AdReport2;
        //   671: getfield        com/nexage/android/reports2/AdReport2.displays:Ljava/util/ArrayList;
        //   674: invokevirtual   java/util/ArrayList.size:()I
        //   677: invokevirtual   java/lang/StringBuilder.append:(I)Ljava/lang/StringBuilder;
        //   680: ldc_w           " clicks:"
        //   683: invokevirtual   java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
        //   686: getstatic       com/nexage/android/reports2/ReportSender.report:Lcom/nexage/android/reports2/AdReport2;
        //   689: getfield        com/nexage/android/reports2/AdReport2.clicks:Ljava/util/ArrayList;
        //   692: invokevirtual   java/util/ArrayList.size:()I
        //   695: invokevirtual   java/lang/StringBuilder.append:(I)Ljava/lang/StringBuilder;
        //   698: invokevirtual   java/lang/StringBuilder.toString:()Ljava/lang/String;
        //   701: invokestatic    com/nexage/android/internal/NexageLog.i:(Ljava/lang/String;Ljava/lang/String;)V
        //   704: getstatic       com/nexage/android/reports2/ReportSender.totalReqs:I
        //   707: getstatic       com/nexage/android/reports2/ReportSender.report:Lcom/nexage/android/reports2/AdReport2;
        //   710: getfield        com/nexage/android/reports2/AdReport2.reqs:Ljava/util/ArrayList;
        //   713: invokevirtual   java/util/ArrayList.size:()I
        //   716: iadd           
        //   717: putstatic       com/nexage/android/reports2/ReportSender.totalReqs:I
        //   720: getstatic       com/nexage/android/reports2/ReportSender.totalDisplays:I
        //   723: getstatic       com/nexage/android/reports2/ReportSender.report:Lcom/nexage/android/reports2/AdReport2;
        //   726: getfield        com/nexage/android/reports2/AdReport2.displays:Ljava/util/ArrayList;
        //   729: invokevirtual   java/util/ArrayList.size:()I
        //   732: iadd           
        //   733: putstatic       com/nexage/android/reports2/ReportSender.totalDisplays:I
        //   736: getstatic       com/nexage/android/reports2/ReportSender.totalClicks:I
        //   739: getstatic       com/nexage/android/reports2/ReportSender.report:Lcom/nexage/android/reports2/AdReport2;
        //   742: getfield        com/nexage/android/reports2/AdReport2.clicks:Ljava/util/ArrayList;
        //   745: invokevirtual   java/util/ArrayList.size:()I
        //   748: iadd           
        //   749: putstatic       com/nexage/android/reports2/ReportSender.totalClicks:I
        //   752: iconst_1       
        //   753: istore          12
        //   755: iload           12
        //   757: invokestatic    com/nexage/android/reports2/ReportManager.reportFlushFinished:(Z)V
        //   760: aload_3        
        //   761: ifnull          776
        //   764: aload_3        
        //   765: invokevirtual   java/io/OutputStream.close:()V
        //   768: ldc             "ReportSender"
        //   770: ldc_w           "close out"
        //   773: invokestatic    com/nexage/android/internal/NexageLog.d:(Ljava/lang/String;Ljava/lang/String;)V
        //   776: aload_2        
        //   777: ifnull          792
        //   780: aload_2        
        //   781: invokevirtual   java/net/HttpURLConnection.disconnect:()V
        //   784: ldc             "ReportSender"
        //   786: ldc_w           "disconnect connection"
        //   789: invokestatic    com/nexage/android/internal/NexageLog.d:(Ljava/lang/String;Ljava/lang/String;)V
        //   792: aload           5
        //   794: athrow         
        //   795: ldc             "ReportSender"
        //   797: ldc_w           "submission failed, rollback"
        //   800: invokestatic    com/nexage/android/internal/NexageLog.i:(Ljava/lang/String;Ljava/lang/String;)V
        //   803: iconst_0       
        //   804: istore          12
        //   806: goto            755
        //   809: astore          9
        //   811: ldc             "ReportSender"
        //   813: ldc_w           "commit block failed"
        //   816: aload           9
        //   818: invokestatic    com/nexage/android/internal/NexageLog.e:(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)V
        //   821: aload_3        
        //   822: ifnull          837
        //   825: aload_3        
        //   826: invokevirtual   java/io/OutputStream.close:()V
        //   829: ldc             "ReportSender"
        //   831: ldc_w           "close out"
        //   834: invokestatic    com/nexage/android/internal/NexageLog.d:(Ljava/lang/String;Ljava/lang/String;)V
        //   837: aload_2        
        //   838: ifnull          792
        //   841: aload_2        
        //   842: invokevirtual   java/net/HttpURLConnection.disconnect:()V
        //   845: ldc             "ReportSender"
        //   847: ldc_w           "disconnect connection"
        //   850: invokestatic    com/nexage/android/internal/NexageLog.d:(Ljava/lang/String;Ljava/lang/String;)V
        //   853: goto            792
        //   856: astore          10
        //   858: goto            792
        //   861: astore          6
        //   863: aload_3        
        //   864: ifnull          879
        //   867: aload_3        
        //   868: invokevirtual   java/io/OutputStream.close:()V
        //   871: ldc             "ReportSender"
        //   873: ldc_w           "close out"
        //   876: invokestatic    com/nexage/android/internal/NexageLog.d:(Ljava/lang/String;Ljava/lang/String;)V
        //   879: aload_2        
        //   880: ifnull          895
        //   883: aload_2        
        //   884: invokevirtual   java/net/HttpURLConnection.disconnect:()V
        //   887: ldc             "ReportSender"
        //   889: ldc_w           "disconnect connection"
        //   892: invokestatic    com/nexage/android/internal/NexageLog.d:(Ljava/lang/String;Ljava/lang/String;)V
        //   895: aload           6
        //   897: athrow         
        //   898: ldc             "ReportSender"
        //   900: ldc_w           "submission failed, rollback"
        //   903: invokestatic    com/nexage/android/internal/NexageLog.i:(Ljava/lang/String;Ljava/lang/String;)V
        //   906: iconst_0       
        //   907: istore          26
        //   909: goto            575
        //   912: astore          23
        //   914: ldc             "ReportSender"
        //   916: ldc_w           "commit block failed"
        //   919: aload           23
        //   921: invokestatic    com/nexage/android/internal/NexageLog.e:(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)V
        //   924: aload           16
        //   926: ifnull          942
        //   929: aload           16
        //   931: invokevirtual   java/io/OutputStream.close:()V
        //   934: ldc             "ReportSender"
        //   936: ldc_w           "close out"
        //   939: invokestatic    com/nexage/android/internal/NexageLog.d:(Ljava/lang/String;Ljava/lang/String;)V
        //   942: aload           17
        //   944: ifnull          385
        //   947: aload           17
        //   949: invokevirtual   java/net/HttpURLConnection.disconnect:()V
        //   952: ldc             "ReportSender"
        //   954: ldc_w           "disconnect connection"
        //   957: invokestatic    com/nexage/android/internal/NexageLog.d:(Ljava/lang/String;Ljava/lang/String;)V
        //   960: return         
        //   961: astore          20
        //   963: aload           16
        //   965: ifnull          981
        //   968: aload           16
        //   970: invokevirtual   java/io/OutputStream.close:()V
        //   973: ldc             "ReportSender"
        //   975: ldc_w           "close out"
        //   978: invokestatic    com/nexage/android/internal/NexageLog.d:(Ljava/lang/String;Ljava/lang/String;)V
        //   981: aload           17
        //   983: ifnull          999
        //   986: aload           17
        //   988: invokevirtual   java/net/HttpURLConnection.disconnect:()V
        //   991: ldc             "ReportSender"
        //   993: ldc_w           "disconnect connection"
        //   996: invokestatic    com/nexage/android/internal/NexageLog.d:(Ljava/lang/String;Ljava/lang/String;)V
        //   999: aload           20
        //  1001: athrow         
        //  1002: ldc             "ReportSender"
        //  1004: ldc_w           "submission failed, rollback"
        //  1007: invokestatic    com/nexage/android/internal/NexageLog.i:(Ljava/lang/String;Ljava/lang/String;)V
        //  1010: iconst_0       
        //  1011: istore          40
        //  1013: goto            346
        //  1016: astore          38
        //  1018: ldc             "ReportSender"
        //  1020: ldc_w           "commit block failed"
        //  1023: aload           38
        //  1025: invokestatic    com/nexage/android/internal/NexageLog.e:(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)V
        //  1028: aload_3        
        //  1029: ifnull          1044
        //  1032: aload_3        
        //  1033: invokevirtual   java/io/OutputStream.close:()V
        //  1036: ldc             "ReportSender"
        //  1038: ldc_w           "close out"
        //  1041: invokestatic    com/nexage/android/internal/NexageLog.d:(Ljava/lang/String;Ljava/lang/String;)V
        //  1044: aload           29
        //  1046: ifnull          385
        //  1049: aload           29
        //  1051: invokevirtual   java/net/HttpURLConnection.disconnect:()V
        //  1054: ldc             "ReportSender"
        //  1056: ldc_w           "disconnect connection"
        //  1059: invokestatic    com/nexage/android/internal/NexageLog.d:(Ljava/lang/String;Ljava/lang/String;)V
        //  1062: return         
        //  1063: astore          35
        //  1065: aload_3        
        //  1066: ifnull          1081
        //  1069: aload_3        
        //  1070: invokevirtual   java/io/OutputStream.close:()V
        //  1073: ldc             "ReportSender"
        //  1075: ldc_w           "close out"
        //  1078: invokestatic    com/nexage/android/internal/NexageLog.d:(Ljava/lang/String;Ljava/lang/String;)V
        //  1081: aload           29
        //  1083: ifnull          1099
        //  1086: aload           29
        //  1088: invokevirtual   java/net/HttpURLConnection.disconnect:()V
        //  1091: ldc             "ReportSender"
        //  1093: ldc_w           "disconnect connection"
        //  1096: invokestatic    com/nexage/android/internal/NexageLog.d:(Ljava/lang/String;Ljava/lang/String;)V
        //  1099: aload           35
        //  1101: athrow         
        //  1102: astore          39
        //  1104: goto            1044
        //  1107: astore          41
        //  1109: goto            367
        //  1112: astore          36
        //  1114: goto            1099
        //  1117: astore          37
        //  1119: goto            1081
        //  1122: astore          25
        //  1124: goto            942
        //  1127: astore          27
        //  1129: goto            598
        //  1132: astore          21
        //  1134: goto            999
        //  1137: astore          22
        //  1139: goto            981
        //  1142: astore          11
        //  1144: goto            837
        //  1147: astore          13
        //  1149: goto            776
        //  1152: astore          7
        //  1154: goto            895
        //  1157: astore          8
        //  1159: goto            879
        //  1162: astore          31
        //  1164: aload           29
        //  1166: astore_2       
        //  1167: aload           31
        //  1169: astore          5
        //  1171: goto            622
        //  1174: astore          5
        //  1176: iload           18
        //  1178: istore          19
        //  1180: aload           17
        //  1182: astore_2       
        //  1183: aload           16
        //  1185: astore_3       
        //  1186: iload           19
        //  1188: istore          4
        //  1190: goto            622
        //  1193: astore          30
        //  1195: iload           4
        //  1197: istore          18
        //  1199: aload           29
        //  1201: astore          17
        //  1203: aload           30
        //  1205: astore          14
        //  1207: aconst_null    
        //  1208: astore          16
        //  1210: goto            402
        //  1213: astore          34
        //  1215: iload           4
        //  1217: istore          18
        //  1219: aload_3        
        //  1220: astore          16
        //  1222: aload           29
        //  1224: astore          17
        //  1226: aload           34
        //  1228: astore          14
        //  1230: goto            402
        //    Exceptions:
        //  Try           Handler
        //  Start  End    Start  End    Type                 
        //  -----  -----  -----  -----  ---------------------
        //  39     70     386    402    Ljava/lang/Exception;
        //  39     70     620    622    Any
        //  70     122    1193   1213   Ljava/lang/Exception;
        //  70     122    1162   1174   Any
        //  129    148    1193   1213   Ljava/lang/Exception;
        //  129    148    1162   1174   Any
        //  148    160    1193   1213   Ljava/lang/Exception;
        //  148    160    1162   1174   Any
        //  163    213    1213   1233   Ljava/lang/Exception;
        //  163    213    1162   1174   Any
        //  229    343    1016   1063   Ljava/lang/Exception;
        //  229    343    1063   1122   Any
        //  346    351    1016   1063   Ljava/lang/Exception;
        //  346    351    1063   1122   Any
        //  355    367    1107   1112   Ljava/lang/Exception;
        //  372    385    617    620    Ljava/lang/Exception;
        //  402    442    1174   1193   Any
        //  458    572    912    961    Ljava/lang/Exception;
        //  458    572    961    1142   Any
        //  575    580    912    961    Ljava/lang/Exception;
        //  575    580    961    1142   Any
        //  585    598    1127   1132   Ljava/lang/Exception;
        //  603    616    617    620    Ljava/lang/Exception;
        //  638    752    809    856    Ljava/lang/Exception;
        //  638    752    861    1162   Any
        //  755    760    809    856    Ljava/lang/Exception;
        //  755    760    861    1162   Any
        //  764    776    1147   1152   Ljava/lang/Exception;
        //  780    792    856    861    Ljava/lang/Exception;
        //  795    803    809    856    Ljava/lang/Exception;
        //  795    803    861    1162   Any
        //  811    821    861    1162   Any
        //  825    837    1142   1147   Ljava/lang/Exception;
        //  841    853    856    861    Ljava/lang/Exception;
        //  867    879    1157   1162   Ljava/lang/Exception;
        //  883    895    1152   1157   Ljava/lang/Exception;
        //  898    906    912    961    Ljava/lang/Exception;
        //  898    906    961    1142   Any
        //  914    924    961    1142   Any
        //  929    942    1122   1127   Ljava/lang/Exception;
        //  947    960    617    620    Ljava/lang/Exception;
        //  968    981    1137   1142   Ljava/lang/Exception;
        //  986    999    1132   1137   Ljava/lang/Exception;
        //  1002   1010   1016   1063   Ljava/lang/Exception;
        //  1002   1010   1063   1122   Any
        //  1018   1028   1063   1122   Any
        //  1032   1044   1102   1107   Ljava/lang/Exception;
        //  1049   1062   617    620    Ljava/lang/Exception;
        //  1069   1081   1117   1122   Ljava/lang/Exception;
        //  1086   1099   1112   1117   Ljava/lang/Exception;
        // 
        // The error that occurred was:
        // 
        // java.lang.IndexOutOfBoundsException: Index: 0, Size: 0
        //     at java.util.ArrayList.rangeCheck(ArrayList.java:653)
        //     at java.util.ArrayList.get(ArrayList.java:429)
        //     at com.strobel.decompiler.ast.AstBuilder.convertLocalVariables(AstBuilder.java:3035)
        //     at com.strobel.decompiler.ast.AstBuilder.performStackAnalysis(AstBuilder.java:2445)
        //     at com.strobel.decompiler.ast.AstBuilder.build(AstBuilder.java:108)
        //     at com.strobel.decompiler.languages.java.ast.AstMethodBodyBuilder.createMethodBody(AstMethodBodyBuilder.java:210)
        //     at com.strobel.decompiler.languages.java.ast.AstMethodBodyBuilder.createMethodBody(AstMethodBodyBuilder.java:99)
        //     at com.strobel.decompiler.languages.java.ast.AstBuilder.createMethodBody(AstBuilder.java:757)
        //     at com.strobel.decompiler.languages.java.ast.AstBuilder.createMethod(AstBuilder.java:655)
        //     at com.strobel.decompiler.languages.java.ast.AstBuilder.addTypeMembers(AstBuilder.java:532)
        //     at com.strobel.decompiler.languages.java.ast.AstBuilder.createTypeCore(AstBuilder.java:499)
        //     at com.strobel.decompiler.languages.java.ast.AstBuilder.createTypeNoCache(AstBuilder.java:141)
        //     at com.strobel.decompiler.languages.java.ast.AstBuilder.createType(AstBuilder.java:130)
        //     at com.strobel.decompiler.languages.java.ast.AstBuilder.addType(AstBuilder.java:105)
        //     at com.strobel.decompiler.languages.java.JavaLanguage.buildAst(JavaLanguage.java:71)
        //     at com.strobel.decompiler.languages.java.JavaLanguage.decompileType(JavaLanguage.java:59)
        //     at com.strobel.decompiler.DecompilerDriver.decompileType(DecompilerDriver.java:317)
        //     at com.strobel.decompiler.DecompilerDriver.decompileJar(DecompilerDriver.java:238)
        //     at com.strobel.decompiler.DecompilerDriver.main(DecompilerDriver.java:123)
        // 
        throw new IllegalStateException("An error occurred while decompiling this method.");
    }
    
    public static void startFlush(final Context context) {
        NexageLog.d("ReportSender", "startFlush");
        ReportSender.report = new AdReport2();
        ReportPersistMgr.updateAndReadRecords();
        if (ReportSender.report.reqs.size() == 0 && ReportSender.report.displays.size() == 0 && ReportSender.report.clicks.size() == 0) {
            NexageLog.d("ReportSender", "nothing to flush");
            ReportManager.reportFlushFinished(false);
        }
        else {
            try {
                NexageLog.d("ReportSender", "generating JSON report");
                ReportSender.reportJson = ReportSender.report.toJson();
                addImpressionGroupsToReport();
                NexageLog.d("ReportSender", "flushing: " + ReportSender.reportJson);
                if (ReportSender.reportJson != null) {
                    new Timer().schedule(new TimerTask() {
                        @Override
                        public final void run() {
                            buildParams(context);
                        }
                    }, 100L);
                    ReportManager.setFlushing(true);
                }
            }
            catch (JSONException ex) {
                NexageLog.e("ReportSender", "JSON exception", (Throwable)ex);
            }
        }
    }
}
