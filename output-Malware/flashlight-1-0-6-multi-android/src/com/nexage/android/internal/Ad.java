// 
// Decompiled by Procyon v0.5.30
// 

package com.nexage.android.internal;

import com.nexage.android.NexageActivity;
import android.app.Activity;
import android.text.TextUtils;
import com.nexage.android.reports2.AdDisplay;
import com.nexage.android.v2.TagInfo;
import com.nexage.android.reports2.AdClick;
import android.content.Intent;
import android.annotation.SuppressLint;
import com.nexage.android.reports2.ReportManager;
import com.nexage.android.v2.Task;
import com.nexage.android.rules.AdTag;
import com.nexage.android.reports2.AdService2;
import com.nexage.android.NexageAdViewListener;
import com.nexage.android.NexageAdView;

public abstract class Ad
{
    private static final String HEXDIGITS = "0123456789ABCDEF";
    protected String adHtml;
    protected AdLayout adLayout;
    private String buyer;
    protected int height;
    public volatile boolean isAdViewed;
    protected NexageAdSwitcher nexageAdSwitcher;
    protected NexageAdView nexageAdView;
    protected NexageAdViewListener nexageAdViewListener;
    protected NexageContext nexageContext;
    private String priceUnit;
    protected long responseTime;
    protected final AdService2 service;
    protected AdTag tag;
    public Task task;
    protected final long timestamp;
    protected int width;
    
    protected Ad(final NexageContext nexageContext, final AdService2 service) {
        this.isAdViewed = false;
        this.timestamp = ReportManager.getTimestamp();
        this.nexageContext = nexageContext;
        this.service = service;
        if (service != null && nexageContext != null && nexageContext.interstitialLayout() != null) {
            service.readyToReport();
        }
    }
    
    protected static void append(final StringBuffer sb, final String s, final Integer n) {
        if (n != null) {
            sb.append(s);
            sb.append("#");
            final char[] array = new char[2];
            sb.append(byteToHex((0xFF0000 & n) >> 16, array));
            sb.append(byteToHex((0xFF00 & n) >> 8, array));
            sb.append(byteToHex(0xFF & n, array));
        }
    }
    
    public static char[] byteToHex(final int n, final char[] array) {
        array[0] = "0123456789ABCDEF".charAt((n & 0xF0) >> 4);
        array[1] = "0123456789ABCDEF".charAt(n & 0xF);
        return array;
    }
    
    public static String getJavascriptPopupBlocker() {
        return "function alert() {}; function prompt() {}; function confirm() {};";
    }
    
    @SuppressLint({ "DefaultLocale" })
    public static int hexToInt(final String s) {
        int n = 0;
        for (int i = 1; i < s.length(); ++i) {
            n = (n << 4 | "0123456789ABCDEF".indexOf(s.toUpperCase().charAt(i)));
        }
        return n;
    }
    
    public static boolean isMraid(final String s) {
        return s != null && s.indexOf("mraid.js") != -1;
    }
    
    public static boolean readyToReport(final NexageAdView nexageAdView) {
        return nexageAdView.readyToReport();
    }
    
    protected void SDKAdVisible(final boolean b) {
        this.nexageContext.SDKAdVisible(b);
    }
    
    public boolean activityFinished(final Intent intent) {
        return false;
    }
    
    protected boolean addClickToReport() {
        if (this.service != null) {
            if (this.task == null) {
                final AdService2 service = this.service;
                final String position = this.service.position;
                String tagId;
                if (this.tag == null) {
                    tagId = null;
                }
                else {
                    tagId = this.tag.tagId;
                }
                return ReportManager.addClickEvent(service, new AdClick(position, tagId, this.service.getAGuid()));
            }
            NexageLog.d("Ad.addDisplayToReport using Task");
            ReportManager.addClickEvent(this.service, this.task);
        }
        return false;
    }
    
    public AdDisplay addDisplayToReport() {
        synchronized (this) {
            final AdService2 service = this.service;
            AdDisplay adDisplay = null;
            if (service != null) {
                if (this.task != null) {
                    NexageLog.d("Ad.addDisplayToReport using Task");
                    ReportManager.addDisplayEvent(this.service, this.task);
                }
                else {
                    final String position = this.service.position;
                    final AdTag tag = this.tag;
                    String tagId = null;
                    if (tag != null) {
                        tagId = this.tag.tagId;
                    }
                    final AdDisplay adDisplay2 = new AdDisplay(position, tagId);
                    if (!TextUtils.isEmpty((CharSequence)this.priceUnit) && !TextUtils.isEmpty((CharSequence)this.buyer)) {
                        adDisplay2.setRTB(this.priceUnit, this.buyer);
                    }
                    ReportManager.addDisplayEvent(this.service, adDisplay2);
                    adDisplay = adDisplay2;
                }
            }
            return adDisplay;
        }
    }
    
    protected void addRequestToReport(final int n, final AdTag adTag) {
        if (this.service != null) {
            final TagInfo tagInfo = new TagInfo(n, this.timestamp, adTag);
            if (!TextUtils.isEmpty((CharSequence)this.priceUnit) && !TextUtils.isEmpty((CharSequence)this.buyer)) {
                this.service.setRTB(this.priceUnit, this.buyer);
                tagInfo.pru = this.priceUnit;
                tagInfo.buyer = this.buyer;
            }
            tagInfo.setResponseTime(this.responseTime);
            this.service.addAdNetRequest(tagInfo);
        }
    }
    
    public boolean display() {
        return false;
    }
    
    public int getHeight() {
        int n;
        if (this.nexageContext.interstitialLayout() != null) {
            n = 1;
        }
        else {
            n = 0;
        }
        if (n != 0) {
            return -1;
        }
        return this.height;
    }
    
    public String getHtml() {
        return this.adHtml;
    }
    
    public abstract AdLayout getLayout(final Activity p0);
    
    public NexageAdView getNexageAdView() {
        return this.nexageAdView;
    }
    
    public NexageAdViewListener getNexageListener() {
        return this.nexageAdViewListener;
    }
    
    public String getPosition() {
        return this.nexageContext.getPosition();
    }
    
    public final String getRequestURL(final AdTag adTag) {
        return adTag.adRequestUrl;
    }
    
    public long getResponseTime() {
        return this.responseTime;
    }
    
    public NexageAdSwitcher getSwitcher() {
        boolean b;
        if (this.nexageContext.interstitialLayout() != null) {
            b = true;
        }
        else {
            b = false;
        }
        if (b || this.tag.useSDK) {
            return null;
        }
        return this.nexageAdSwitcher;
    }
    
    public int getWidth() {
        int n;
        if (this.nexageContext.interstitialLayout() != null) {
            n = 1;
        }
        else {
            n = 0;
        }
        if (n != 0) {
            return -1;
        }
        return this.width;
    }
    
    public void init(final NexageActivity nexageActivity) {
    }
    
    public boolean isInterstitial() {
        return this.nexageContext.interstitialLayout() != null;
    }
    
    protected boolean mm4rmExpanded() {
        return this.nexageContext.mm4rmExpanded(this);
    }
    
    protected void mm4rmRestored() {
        this.nexageContext.mm4rmRestored(this);
    }
    
    public int prepare(final String s) {
        return 0;
    }
    
    public void readyToReport() {
        if (this.service != null) {
            this.service.readyToReport();
        }
    }
    
    public void setAGuid(final String aGuid) {
        this.service.setAGuid(aGuid);
    }
    
    public void setAdView(final NexageAdView adView) {
        if (this.service != null) {
            this.service.setAdView(adView);
        }
    }
    
    public void setAttributes(final Integer n, final Integer n2, final String s) {
    }
    
    public void setNexageAdView(final NexageAdView nexageAdView) {
        this.nexageAdView = nexageAdView;
    }
    
    public void setNexageListener(final NexageAdViewListener nexageAdViewListener) {
        this.nexageAdViewListener = nexageAdViewListener;
    }
    
    public void setRTB(final String priceUnit, final String buyer) {
        this.priceUnit = priceUnit;
        this.buyer = buyer;
    }
    
    public void setResponseTime(final long responseTime) {
        this.responseTime = responseTime;
    }
    
    public void setSize(final int width, final int height) {
        this.width = width;
        this.height = height;
    }
    
    public void setSwitcher(final NexageAdSwitcher nexageAdSwitcher) {
        this.nexageAdSwitcher = nexageAdSwitcher;
    }
    
    public void setTag(final AdTag tag) {
        this.tag = tag;
    }
}
