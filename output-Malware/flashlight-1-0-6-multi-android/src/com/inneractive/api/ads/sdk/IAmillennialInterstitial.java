// 
// Decompiled by Procyon v0.5.30
// 

package com.inneractive.api.ads.sdk;

import java.lang.reflect.Method;
import java.lang.reflect.Field;
import android.location.Location;
import java.lang.reflect.Proxy;
import android.view.View;
import android.content.Context;
import java.lang.reflect.InvocationHandler;

class IAmillennialInterstitial extends b implements InvocationHandler
{
    private static String e;
    private Object a;
    private Class b;
    private Object c;
    private b$a d;
    private IAadConfig f;
    private boolean g;
    
    IAmillennialInterstitial() {
        this.g = false;
    }
    
    protected final void a() {
        try {
            final Object a = new IAreflectionHandler$a(this.a, "isAdAvailable").a();
            if (a != null && (boolean)a) {
                new IAreflectionHandler$a(this.a, "display").a();
                return;
            }
            InneractiveAdView$Log.i("Inneractive_info", "Millennial interstitial ad is not ready yet and still loading. Please try again.");
        }
        catch (Exception ex) {
            InneractiveAdView$Log.v("Inneractive_verbose", "Handled Exception:");
            InneractiveAdView$Log.v("Inneractive_verbose", d$a.a(ex));
            InneractiveAdView$Log.d("Inneractive_debug", "Could not show Millennial Media ad using reflection!");
            this.d.a(InneractiveAdView$InneractiveErrorCode.SDK_INTERNAL_ERROR);
        }
    }
    
    protected final void a(final Context context, final b$a d, final IAresponseData aresponseData) {
        this.d = d;
        this.f = IAadConfig.a(aresponseData);
        Label_0261: {
            if (this.f == null) {
                break Label_0261;
            }
            if (this.f.k() != null && this.f.k().get("MM") != null) {
                IAmillennialInterstitial.e = this.f.k().get("MM");
            }
            while (true) {
                while (true) {
                    Class<?> forName = null;
                    Label_0678: {
                        try {
                            new IAreflectionHandler$a(null, "initialize").a(Class.forName("com.millennialmedia.android.MMSDK")).a(Context.class, context).a();
                            new IAreflectionHandler$a(null, "setBroadcastEvents").a(Class.forName("com.millennialmedia.android.MMSDK")).a(Boolean.TYPE, true).a();
                            new IAreflectionHandler$a(null, "setLogLevel").a(Class.forName("com.millennialmedia.android.MMLog")).a(Integer.TYPE, 2).a();
                            this.a = Class.forName("com.millennialmedia.android.MMInterstitial").getConstructor(Context.class).newInstance(context);
                            final Object a = new IAreflectionHandler$a(this.a, "isAdAvailable").a();
                            if (a != null && (boolean)a) {
                                InneractiveAdView$Log.d("Inneractive_debug", "** Millennial interstitial ad already loaded **");
                                this.d.a((View)null);
                            }
                            else {
                                new IAreflectionHandler$a(this.a, "setApid").a(String.class, IAmillennialInterstitial.e).a();
                                this.b = Class.forName("com.millennialmedia.android.RequestListener");
                                this.c = Proxy.newProxyInstance(this.b.getClassLoader(), new Class[] { this.b }, this);
                                new IAreflectionHandler$a(this.a, "setListener").a(this.b, this.c).a();
                                final Location a2 = d$a.a(d$a.e(context), IAadConfig.E());
                                if (a2 != null) {
                                    new IAreflectionHandler$a(null, "setUserLocation").a(Location.class, a2).a(Class.forName("com.millennialmedia.android.MMRequest")).a();
                                }
                                forName = Class.forName("com.millennialmedia.android.MMRequest");
                                final Object instance = Class.forName("com.millennialmedia.android.MMRequest").newInstance();
                                if (this.f.a != -1) {
                                    new IAreflectionHandler$a(instance, "setAge").a(String.class, Integer.toString(this.f.a)).a();
                                }
                                if (this.f.b != null) {
                                    if (!"m".equals(this.f.b)) {
                                        break Label_0678;
                                    }
                                    final Field field = forName.getDeclaredField("GENDER_MALE");
                                    new IAreflectionHandler$a(instance, "setGender").a(String.class, field.get(null)).a();
                                }
                                if (this.f.d != null) {
                                    new IAreflectionHandler$a(instance, "setZip").a(String.class, this.f.d).a();
                                }
                                if (this.f.c != null) {
                                    new IAreflectionHandler$a(instance, "setKeywords").a(String.class, this.f.c).a();
                                }
                                new IAreflectionHandler$a(this.a, "setMMRequest").a(forName, instance).a();
                            }
                            new IAreflectionHandler$a(this.a, "fetch").a();
                            return;
                            this.d.a(InneractiveAdView$InneractiveErrorCode.SDK_INTERNAL_ERROR);
                            return;
                        }
                        catch (Exception ex) {
                            InneractiveAdView$Log.v("Inneractive_verbose", "Handled Exception:");
                            InneractiveAdView$Log.v("Inneractive_verbose", d$a.a(ex));
                            InneractiveAdView$Log.d("Inneractive_debug", "Could not request an ad from Millennial Media using reflection!");
                            this.d.a(InneractiveAdView$InneractiveErrorCode.SDK_INTERNAL_ERROR);
                            return;
                        }
                    }
                    final Field field = forName.getDeclaredField("GENDER_FEMALE");
                    continue;
                }
            }
        }
    }
    
    protected final void b() {
        try {
            this.b = Class.forName("com.millennialmedia.android.RequestListener");
            new IAreflectionHandler$a(this.a, "setListener").a(this.b, null).a();
        }
        catch (Exception ex) {
            InneractiveAdView$Log.v("Inneractive_verbose", "Handled Exception:");
            InneractiveAdView$Log.v("Inneractive_verbose", d$a.a(ex));
            InneractiveAdView$Log.d("Inneractive_debug", "Could not invalidate Millennial Media ad using reflection!");
            this.d.a(InneractiveAdView$InneractiveErrorCode.SDK_INTERNAL_ERROR);
        }
    }
    
    @Override
    public Object invoke(final Object o, final Method method, final Object[] array) {
        if (method.getName().equals("MMAdOverlayClosed")) {
            InneractiveAdView$Log.d("Inneractive_debug", "** Millennial interstitial ad dismissed **");
            this.d.e();
        }
        else {
            if (method.getName().equals("MMAdOverlayLaunched")) {
                InneractiveAdView$Log.d("Inneractive_debug", "** Showing Millennial interstitial ad **");
                if (this.f != null) {
                    this.f.i("MM");
                }
                this.d.a();
                return null;
            }
            if (method.getName().equals("MMAdRequestIsCaching")) {
                InneractiveAdView$Log.d("Inneractive_debug", "** Millennial interstitial ad is caching **");
                return null;
            }
            if (method.getName().equals("onSingleTap")) {
                if (!this.g) {
                    this.g = true;
                    InneractiveAdView$Log.d("Inneractive_debug", "** Millennial interstitial ad clicked **");
                    if (this.f != null) {
                        this.f.j("MM");
                    }
                    this.d.b();
                    return null;
                }
            }
            else {
                if (method.getName().equals("requestCompleted")) {
                    final InneractiveAdView$InneractiveErrorCode connection_ERROR = InneractiveAdView$InneractiveErrorCode.CONNECTION_ERROR;
                    try {
                        final Object a = new IAreflectionHandler$a(this.a, "isAdAvailable").a();
                        if (a != null && (boolean)a) {
                            InneractiveAdView$Log.d("Inneractive_debug", "** Millennial interstitial ad loaded successfully **");
                            if (this.f != null) {
                                this.f.i("MM");
                            }
                            this.d.a((View)null);
                            return null;
                        }
                    }
                    catch (Exception ex) {
                        InneractiveAdView$Log.v("Inneractive_verbose", "Handled Exception:");
                        InneractiveAdView$Log.v("Inneractive_verbose", d$a.a(ex));
                        InneractiveAdView$Log.d("Inneractive_debug", "Could not check if Millennial Media ad is available using reflection!");
                        this.d.a(InneractiveAdView$InneractiveErrorCode.SDK_INTERNAL_ERROR);
                        return null;
                    }
                    InneractiveAdView$Log.d("Inneractive_debug", "** Millennial interstitial ad failed to load **");
                    if (this.f != null) {
                        this.f.i("IA");
                        this.f.g("MM");
                    }
                    this.d.a(connection_ERROR);
                    return null;
                }
                if (method.getName().equals("requestFailed")) {
                    InneractiveAdView$Log.d("Inneractive_debug", "** Millennial interstitial ad failed to load **");
                    if (this.f != null) {
                        this.f.i("IA");
                        this.f.g("MM");
                    }
                    this.d.a(InneractiveAdView$InneractiveErrorCode.NO_FILL);
                    return null;
                }
            }
        }
        return null;
    }
}
