// 
// Decompiled by Procyon v0.5.30
// 

package com.ihs.APlus;

import android.os.Bundle;
import org.json.JSONException;
import android.content.Intent;
import com.ihs.g.g;
import org.json.JSONObject;
import com.ihs.g.c;
import com.ihs.a.d;
import com.ihs.i.o;

public final class b extends o
{
    private final String a;
    private final String b;
    private final String c;
    private final String d;
    private final String e;
    private final String f;
    private final String g;
    private final String h;
    private final String i;
    private final String j;
    private final String k;
    private APlusService l;
    private boolean m;
    private int n;
    private long o;
    
    b(final APlusService l) {
        this.a = "APlusWebSocketHandler";
        this.b = "data";
        this.c = "msgCheck";
        this.d = "bundleID";
        this.e = "iHandyPush_Events";
        this.f = "APlus_WebSocket_Directory_Success";
        this.g = "APlus_WebScoket_Connection_Success";
        this.h = "APlus_WebSocket_Connection_Duration";
        this.i = "APlus_WebSocket_Connection_Duration_Detail";
        this.j = "APlus_WebSocket_Message_Received";
        this.k = "APlus_WebSocket_Message_Check_Received";
        this.m = false;
        this.n = 0;
        this.n = 0;
        this.m = false;
        this.l = l;
        this.o = 0L;
    }
    
    @Override
    public final void a() {
        com.ihs.a.d.a().a("iHandyPush_Events", "APlus_WebSocket_Directory_Success", this.l.getPackageName());
    }
    
    @Override
    public final void a(final int n, final String s) {
        com.ihs.g.c.a("APlusWebSocketHandler", "onClose entrance....., reason is " + s);
        if (this.n == 1) {
            return;
        }
        if (this.o > 0L) {
            final long n2 = System.currentTimeMillis() - this.o;
            String s2;
            if (n2 <= 1000L) {
                s2 = "<=1s";
            }
            else if (n2 <= 3000L) {
                s2 = "1~3s";
            }
            else if (n2 <= 5000L) {
                s2 = "3~5s";
            }
            else if (n2 <= 10000L) {
                s2 = "5~10s";
            }
            else if (n2 <= 30000L) {
                s2 = "10~30s";
            }
            else if (n2 <= 60000L) {
                s2 = "30~60s";
            }
            else if (n2 <= 180000L) {
                s2 = "1~3m";
            }
            else if (n2 <= 300000L) {
                s2 = "3~5m";
            }
            else if (n2 <= 600000L) {
                s2 = "5~10m";
            }
            else if (n2 <= 960000L) {
                s2 = "10~16m";
            }
            else {
                s2 = ">16m";
            }
            com.ihs.a.d.a().a("iHandyPush_Events", "APlus_WebSocket_Connection_Duration", s2);
            com.ihs.a.d.a().a("iHandyPush_Events", "APlus_WebSocket_Connection_Duration_Detail", String.valueOf(s2) + " : " + s);
            this.o = 0L;
        }
        this.n = n;
        String s3 = "unknown";
        switch (n) {
            case 2: {
                s3 = "APlus_WebSocket_Connection_Fail";
                break;
            }
            case 3: {
                s3 = "APlus_WebSocket_Connection_Lost";
                break;
            }
            case 5: {
                s3 = "APlus_WebSocket_Internal_Error";
                break;
            }
            case 4: {
                s3 = "APlus_WebSocket_Protocol_Error";
                break;
            }
            case 6: {
                s3 = "APlus_WebSocket_Server_Error";
                break;
            }
            case 8: {
                s3 = "APlus_WebSocket_Directory_Fail";
                break;
            }
            case 1: {
                s3 = "APlus_WebSocket_Server_Close";
                break;
            }
        }
        final StringBuilder sb = new StringBuilder();
        sb.append(s).append(this.l.b());
        com.ihs.a.d.a().a("iHandyPush_Events", s3, sb.toString());
        if (1 == n || 8 == n) {
            this.m = true;
        }
        this.l.a(this.m);
        this.m = true;
    }
    
    @Override
    public final void a(final byte[] array) {
        while (true) {
            try {
                final Bundle a = com.ihs.g.g.a(new JSONObject(new String(array)).getJSONObject("data"));
                if (a.getString("msgCheck") != null) {
                    com.ihs.a.d.a().a("iHandyPush_Events", "APlus_WebSocket_Message_Check_Received", this.l.getPackageName());
                    return;
                }
                final String string = a.getString("bundleID");
                if (string != null) {
                    final Intent intent = new Intent();
                    intent.setClassName(string, "com.ihs.apps.framework.sub.APPPushReceiver");
                    intent.addCategory(string);
                    intent.setAction("com.ihs.APlus.Received.MSG");
                    intent.putExtras(a);
                    this.l.startService(intent);
                }
                com.ihs.a.d.a().a("iHandyPush_Events", "APlus_WebSocket_Message_Received", this.l.getPackageName());
            }
            catch (JSONException ex) {
                ex.printStackTrace();
                continue;
            }
            break;
        }
    }
    
    @Override
    public final void b() {
        this.o = System.currentTimeMillis();
        com.ihs.a.d.a().a("iHandyPush_Events", "APlus_WebScoket_Connection_Success", this.l.getPackageName());
        this.c();
    }
    
    public final void c() {
        this.n = 0;
        this.m = false;
        this.l.a();
    }
}
