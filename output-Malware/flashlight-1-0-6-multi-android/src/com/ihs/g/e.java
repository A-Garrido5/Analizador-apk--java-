// 
// Decompiled by Procyon v0.5.30
// 

package com.ihs.g;

import android.content.Intent;
import android.net.Uri;
import android.app.Activity;
import android.content.SharedPreferences;
import junit.framework.Assert;
import com.ihs.e.a;
import android.text.TextUtils;
import android.content.Context;
import java.util.HashMap;
import java.util.Map;

public class e
{
    private static final String a;
    private static e i;
    private String b;
    private Map c;
    private String d;
    private String e;
    private String f;
    private String g;
    private String h;
    
    static {
        a = e.class.getSimpleName();
        e.i = null;
    }
    
    private e() {
        this.c = new HashMap();
    }
    
    public static e a() {
        synchronized (e.class) {
            return e.i;
        }
    }
    
    public static e a(final Context context, final String s) {
        synchronized (e.class) {
            return c(context, s);
        }
    }
    
    public static String a(final String s) {
        if (!TextUtils.isEmpty((CharSequence)s)) {
            final int index = s.indexOf("-");
            if (index >= 0) {
                return s.substring(0, index);
            }
        }
        return null;
    }
    
    private String b(final String s) {
        String s2;
        if (this.g.equalsIgnoreCase(s)) {
            s2 = this.d;
        }
        else {
            s2 = com.ihs.g.d.b(this.c, s, "apppackage");
        }
        com.ihs.g.c.a(com.ihs.g.e.a, "getMarketPackageName(" + s + ") = " + s2);
        return s2;
    }
    
    private static e c(final Context context, final String s) {
        synchronized (e.class) {
            if (e.i == null) {
                if (!(e.i = new e()).d(context, s)) {
                    e.i = null;
                }
            }
            else if (!e.i.b.equals(s) && !e.i.d(context, s)) {
                e.i = null;
            }
            return e.i;
        }
    }
    
    private String c(final String s) {
        String s2;
        if (this.g.equalsIgnoreCase(s)) {
            s2 = this.e;
        }
        else {
            s2 = com.ihs.g.d.b(this.c, s, "appurl");
        }
        com.ihs.g.c.a(com.ihs.g.e.a, "getMarketAppUrl(" + s + ") = " + s2);
        return s2;
    }
    
    private boolean d(final Context context, final String b) {
        com.ihs.g.c.a(com.ihs.g.e.a, "initialize(" + b + ")");
        final Map a = com.ihs.g.i.a(b);
        if (a == null) {
            Assert.assertEquals(com.ihs.e.a.x, 1, 2);
        }
        else {
            try {
                final Map d = com.ihs.g.d.d(a, "Data");
                if (d != null && !d.isEmpty()) {
                    (this.g = com.ihs.g.d.a(d, "google", "default")).trim();
                    this.c = com.ihs.g.d.d(d, "markets");
                    if (this.c != null && !this.c.isEmpty()) {
                        this.d = com.ihs.g.d.b(this.c, this.g, "apppackage");
                        this.e = com.ihs.g.d.b(this.c, this.g, "appurl");
                        this.f = com.ihs.g.d.b(this.c, this.g, "weburl");
                        final SharedPreferences sharedPreferences = context.getSharedPreferences(context.getPackageName(), 0);
                        this.h = sharedPreferences.getString("original_market", (String)null);
                        if (this.h == null) {
                            this.h = this.g;
                            sharedPreferences.edit().putString("original_market", this.g).commit();
                        }
                        this.b = b;
                        return true;
                    }
                }
            }
            catch (Exception ex) {
                ex.printStackTrace();
                return false;
            }
        }
        return false;
    }
    
    public final void a(final Activity activity) {
        final String packageName = activity.getPackageName();
        if (com.ihs.g.a.a(activity.getApplicationContext(), this.d)) {
            final Uri parse = Uri.parse(String.valueOf(this.e) + packageName);
            final Intent intent = new Intent("android.intent.action.VIEW");
            intent.setData(parse);
            activity.startActivity(intent);
            return;
        }
        activity.startActivity(new Intent("android.intent.action.VIEW", Uri.parse(String.valueOf(this.f) + packageName)));
    }
    
    public final void a(final Activity activity, final String s, final String s2) {
        final String c = this.c(s);
        final String b = this.b(s);
        if (c != null && b != null && com.ihs.g.a.a(activity.getApplicationContext(), b)) {
            final Uri parse = Uri.parse(String.valueOf(c) + s2);
            final Intent intent = new Intent("android.intent.action.VIEW");
            intent.setData(parse);
            activity.startActivity(intent);
        }
        else {
            String s3;
            if (this.g.equalsIgnoreCase(s)) {
                s3 = this.f;
            }
            else {
                s3 = com.ihs.g.d.b(this.c, s, "weburl");
            }
            com.ihs.g.c.a(com.ihs.g.e.a, "getMarketWebUrl(" + s + ") = " + s3);
            if (s3 != null) {
                activity.startActivity(new Intent("android.intent.action.VIEW", Uri.parse(String.valueOf(s3) + s2)));
            }
        }
    }
    
    public final String b() {
        return this.g;
    }
    
    public final boolean b(final Context context, final String s) {
        if (s != null) {
            s.trim();
            final String b = this.b(s);
            if (b != null && com.ihs.g.a.a(context, b) && this.c(s) != null) {
                return true;
            }
        }
        return false;
    }
    
    public final String c() {
        return this.h;
    }
}
