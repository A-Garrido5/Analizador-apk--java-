// 
// Decompiled by Procyon v0.5.30
// 

package com.mopub.common;

import com.mopub.common.util.Utils;
import android.provider.Settings$Secure;
import android.content.Context;
import android.net.Uri;
import com.mopub.common.util.Strings;

public abstract class BaseUrlGenerator
{
    private static final String IFA_PREFIX = "ifa:";
    private static final String SHA_PREFIX = "sha:";
    private boolean mFirstParam;
    private StringBuilder mStringBuilder;
    
    private String getParamDelimiter() {
        if (this.mFirstParam) {
            this.mFirstParam = false;
            return "?";
        }
        return "&";
    }
    
    protected void addParam(final String s, final String s2) {
        if (s2 == null || Strings.isEmpty(s2)) {
            return;
        }
        this.mStringBuilder.append(this.getParamDelimiter());
        this.mStringBuilder.append(s);
        this.mStringBuilder.append("=");
        this.mStringBuilder.append(Uri.encode(s2));
    }
    
    public abstract String generateUrlString(final String p0);
    
    protected String getAppVersionFromContext(final Context context) {
        try {
            return context.getPackageManager().getPackageInfo(context.getPackageName(), 0).versionName;
        }
        catch (Exception ex) {
            return null;
        }
    }
    
    protected String getFinalUrlString() {
        return this.mStringBuilder.toString();
    }
    
    protected String getUdidFromContext(final Context context) {
        final String advertisingId = GpsHelper.getAdvertisingId(context);
        if (advertisingId != null) {
            return "ifa:" + advertisingId;
        }
        final String string = Settings$Secure.getString(context.getContentResolver(), "android_id");
        String sha1;
        if (string == null) {
            sha1 = "";
        }
        else {
            sha1 = Utils.sha1(string);
        }
        return "sha:" + sha1;
    }
    
    protected void initUrlString(final String s, final String s2) {
        this.mStringBuilder = new StringBuilder("http://" + s + s2);
        this.mFirstParam = true;
    }
    
    protected void setApiVersion(final String s) {
        this.addParam("v", s);
    }
    
    protected void setAppVersion(final String s) {
        this.addParam("av", s);
    }
    
    protected void setDeviceInfo(final String... array) {
        final StringBuilder sb = new StringBuilder();
        if (array == null || array.length <= 0) {
            return;
        }
        for (int i = 0; i < -1 + array.length; ++i) {
            sb.append(array[i]).append(",");
        }
        sb.append(array[-1 + array.length]);
        this.addParam("dn", sb.toString());
    }
    
    protected void setDoNotTrack(final boolean b) {
        if (b) {
            this.addParam("dnt", "1");
        }
    }
    
    protected void setExternalStoragePermission(final boolean b) {
        String s;
        if (b) {
            s = "1";
        }
        else {
            s = "0";
        }
        this.addParam("android_perms_ext_storage", s);
    }
    
    protected void setUdid(final String s) {
        this.addParam("udid", s);
    }
}
