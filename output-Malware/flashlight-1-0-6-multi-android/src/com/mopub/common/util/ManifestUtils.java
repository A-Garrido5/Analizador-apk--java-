// 
// Decompiled by Procyon v0.5.30
// 

package com.mopub.common.util;

import java.util.Iterator;
import android.content.Intent;
import android.widget.Toast;
import android.content.Context;
import com.mopub.common.MoPubBrowser;
import com.mopub.mobileads.MraidVideoPlayerActivity;
import com.mopub.mobileads.MraidActivity;
import com.mopub.mobileads.MoPubActivity;
import java.util.ArrayList;
import java.util.List;

public class ManifestUtils
{
    private static final List REQUIRED_NATIVE_SDK_ACTIVITIES;
    private static final List REQUIRED_WEB_VIEW_SDK_ACTIVITIES;
    
    static {
        (REQUIRED_WEB_VIEW_SDK_ACTIVITIES = new ArrayList(4)).add(MoPubActivity.class);
        ManifestUtils.REQUIRED_WEB_VIEW_SDK_ACTIVITIES.add(MraidActivity.class);
        ManifestUtils.REQUIRED_WEB_VIEW_SDK_ACTIVITIES.add(MraidVideoPlayerActivity.class);
        ManifestUtils.REQUIRED_WEB_VIEW_SDK_ACTIVITIES.add(MoPubBrowser.class);
        (REQUIRED_NATIVE_SDK_ACTIVITIES = new ArrayList(1)).add(MoPubBrowser.class);
    }
    
    public static void checkNativeActivitiesDeclared(final Context context) {
        displayWarningForMissingActivities(context, ManifestUtils.REQUIRED_NATIVE_SDK_ACTIVITIES);
    }
    
    public static void checkWebViewActivitiesDeclared(final Context context) {
        displayWarningForMissingActivities(context, ManifestUtils.REQUIRED_WEB_VIEW_SDK_ACTIVITIES);
    }
    
    static void displayWarningForMissingActivities(final Context context, final List list) {
        if (context != null) {
            final List undeclaredActivities = getUndeclaredActivities(context, list);
            if (!undeclaredActivities.isEmpty()) {
                if (isDebuggable(context)) {
                    final Toast text = Toast.makeText(context, (CharSequence)"ERROR: YOUR MOPUB INTEGRATION IS INCOMPLETE.\nCheck logcat and update your AndroidManifest.xml with the correct activities.", 1);
                    text.setGravity(7, 0, 0);
                    text.show();
                }
                logMissingActivities(undeclaredActivities);
            }
        }
    }
    
    @Deprecated
    static List getRequiredNativeSdkActivities() {
        return ManifestUtils.REQUIRED_NATIVE_SDK_ACTIVITIES;
    }
    
    @Deprecated
    static List getRequiredWebViewSdkActivities() {
        return ManifestUtils.REQUIRED_WEB_VIEW_SDK_ACTIVITIES;
    }
    
    private static List getUndeclaredActivities(final Context context, final List list) {
        final ArrayList<String> list2 = new ArrayList<String>();
        for (final Class clazz : list) {
            if (!IntentUtils.deviceCanHandleIntent(context, new Intent(context, (Class)clazz))) {
                list2.add(clazz.getName());
            }
        }
        return list2;
    }
    
    static boolean isDebuggable(final Context context) {
        return context != null && context.getApplicationInfo() != null && Utils.bitMaskContainsFlag(context.getApplicationInfo().flags, 2);
    }
    
    private static void logMissingActivities(final List list) {
        final StringBuilder sb = new StringBuilder("AndroidManifest permissions for the following required MoPub activities are missing:\n");
        final Iterator<String> iterator = list.iterator();
        while (iterator.hasNext()) {
            sb.append("\n\t").append(iterator.next());
        }
        sb.append("\n\nPlease update your manifest to include them.");
        MoPubLog.w(sb.toString());
    }
}
