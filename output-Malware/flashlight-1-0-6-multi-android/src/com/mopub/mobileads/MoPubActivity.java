// 
// Decompiled by Procyon v0.5.30
// 

package com.mopub.mobileads;

import android.os.Bundle;
import android.view.View;
import android.content.ActivityNotFoundException;
import android.util.Log;
import android.webkit.WebView;
import android.webkit.WebViewClient;
import com.mopub.mobileads.factories.HtmlInterstitialWebViewFactory;
import java.io.Serializable;
import android.content.Intent;
import android.content.Context;

public class MoPubActivity extends BaseInterstitialActivity
{
    private HtmlInterstitialWebView mHtmlInterstitialWebView;
    
    static Intent createIntent(final Context context, final String s, final boolean b, final String s2, final String s3, final AdConfiguration adConfiguration) {
        final Intent intent = new Intent(context, (Class)MoPubActivity.class);
        intent.putExtra("Html-Response-Body", s);
        intent.putExtra("Scrollable", b);
        intent.putExtra("Clickthrough-Url", s3);
        intent.putExtra("Redirect-Url", s2);
        intent.putExtra("Ad-Configuration", (Serializable)adConfiguration);
        intent.addFlags(268435456);
        return intent;
    }
    
    static void preRenderHtml(final Context context, final CustomEventInterstitial$CustomEventInterstitialListener customEventInterstitial$CustomEventInterstitialListener, final String s) {
        final HtmlInterstitialWebView create = HtmlInterstitialWebViewFactory.create(context, customEventInterstitial$CustomEventInterstitialListener, false, null, null, null);
        create.enablePlugins(false);
        create.addMoPubUriJavascriptInterface(new HtmlInterstitialWebView$MoPubUriJavascriptFireFinishLoadListener() {
            @Override
            public void onInterstitialLoaded() {
                customEventInterstitial$CustomEventInterstitialListener.onInterstitialLoaded();
            }
        });
        create.setWebViewClient((WebViewClient)new WebViewClient() {
            public boolean shouldOverrideUrlLoading(final WebView webView, final String s) {
                if (s.equals("mopub://finishLoad")) {
                    customEventInterstitial$CustomEventInterstitialListener.onInterstitialLoaded();
                }
                else if (s.equals("mopub://failLoad")) {
                    customEventInterstitial$CustomEventInterstitialListener.onInterstitialFailed(null);
                }
                return true;
            }
        });
        create.loadHtmlResponse(s);
    }
    
    public static void start(final Context context, final String s, final boolean b, final String s2, final String s3, final AdConfiguration adConfiguration) {
        final Intent intent = createIntent(context, s, b, s2, s3, adConfiguration);
        try {
            context.startActivity(intent);
        }
        catch (ActivityNotFoundException ex) {
            Log.d("MoPubActivity", "MoPubActivity not found - did you declare it in AndroidManifest.xml?");
        }
    }
    
    @Override
    public View getAdView() {
        final Intent intent = this.getIntent();
        (this.mHtmlInterstitialWebView = HtmlInterstitialWebViewFactory.create(this.getApplicationContext(), new MoPubActivity$BroadcastingInterstitialListener(this), intent.getBooleanExtra("Scrollable", false), intent.getStringExtra("Redirect-Url"), intent.getStringExtra("Clickthrough-Url"), this.getAdConfiguration())).loadHtmlResponse(intent.getStringExtra("Html-Response-Body"));
        return (View)this.mHtmlInterstitialWebView;
    }
    
    @Override
    protected void onCreate(final Bundle bundle) {
        super.onCreate(bundle);
        EventForwardingBroadcastReceiver.broadcastAction((Context)this, this.getBroadcastIdentifier(), "com.mopub.action.interstitial.show");
    }
    
    @Override
    protected void onDestroy() {
        this.mHtmlInterstitialWebView.loadUrl(BaseInterstitialActivity$JavaScriptWebViewCallbacks.WEB_VIEW_DID_CLOSE.getUrl());
        this.mHtmlInterstitialWebView.destroy();
        EventForwardingBroadcastReceiver.broadcastAction((Context)this, this.getBroadcastIdentifier(), "com.mopub.action.interstitial.dismiss");
        super.onDestroy();
    }
}
