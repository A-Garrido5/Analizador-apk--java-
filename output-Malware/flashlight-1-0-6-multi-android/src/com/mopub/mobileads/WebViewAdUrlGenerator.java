// 
// Decompiled by Procyon v0.5.30
// 

package com.mopub.mobileads;

import com.mopub.mobileads.util.Mraids;
import com.mopub.common.GpsHelper;
import android.os.Build;
import android.content.Context;
import com.mopub.common.AdUrlGenerator;

public class WebViewAdUrlGenerator extends AdUrlGenerator
{
    public WebViewAdUrlGenerator(final Context context) {
        super(context);
    }
    
    private static String addKeyword(final String s, String s2) {
        if (s2 == null || s2.length() == 0) {
            s2 = s;
        }
        else if (s != null && s.length() != 0) {
            return String.valueOf(s) + "," + s2;
        }
        return s2;
    }
    
    private boolean detectIsMraidSupported() {
        try {
            Class.forName("com.mopub.mobileads.MraidView");
            return true;
        }
        catch (ClassNotFoundException ex) {
            return false;
        }
    }
    
    private static String getFacebookKeyword(final Context context, final boolean b) {
        if (!b) {
            return null;
        }
        try {
            final Class<?> forName = Class.forName("com.mopub.mobileads.FacebookKeywordProvider");
            return (String)forName.getMethod("getKeyword", Context.class).invoke(forName, context);
        }
        catch (Exception ex) {
            return null;
        }
    }
    
    @Override
    public String generateUrlString(final String s) {
        this.initUrlString(s, "/m/ad");
        this.setApiVersion("6");
        this.setAdUnitId(this.mAdUnitId);
        this.setSdkVersion("2.3");
        this.setDeviceInfo(Build.MANUFACTURER, Build.MODEL, Build.PRODUCT);
        this.setUdid(this.getUdidFromContext(this.mContext));
        this.setDoNotTrack(GpsHelper.isLimitAdTrackingEnabled(this.mContext));
        this.setKeywords(addKeyword(this.mKeywords, getFacebookKeyword(this.mContext, this.mFacebookSupportEnabled)));
        this.setLocation(this.mLocation);
        this.setTimezone(AdUrlGenerator.getTimeZoneOffsetString());
        this.setOrientation(this.mContext.getResources().getConfiguration().orientation);
        this.setDensity(this.mContext.getResources().getDisplayMetrics().density);
        this.setMraidFlag(this.detectIsMraidSupported());
        final String networkOperator = this.getNetworkOperator();
        this.setMccCode(networkOperator);
        this.setMncCode(networkOperator);
        this.setIsoCountryCode(this.mTelephonyManager.getNetworkCountryIso());
        this.setCarrierName(this.mTelephonyManager.getNetworkOperatorName());
        this.setNetworkType(this.getActiveNetworkType());
        this.setAppVersion(this.getAppVersionFromContext(this.mContext));
        this.setExternalStoragePermission(Mraids.isStorePictureSupported(this.mContext));
        this.setTwitterAppInstalledFlag();
        return this.getFinalUrlString();
    }
}
