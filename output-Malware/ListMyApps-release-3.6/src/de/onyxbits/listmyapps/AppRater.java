// 
// Decompiled by Procyon v0.5.30
// 

package de.onyxbits.listmyapps;

import android.content.ActivityNotFoundException;
import android.content.Intent;
import android.net.Uri;
import android.content.DialogInterface;
import android.app.AlertDialog$Builder;
import android.content.SharedPreferences$Editor;
import android.content.SharedPreferences;
import android.util.Log;
import android.content.Context;
import android.content.DialogInterface$OnClickListener;

class AppRater implements DialogInterface$OnClickListener
{
    private static final int DAYS_UNTIL_PROMPT = 7;
    private static final int LAUNCHES_UNTIL_PROMPT = 14;
    private static final String PREFSFILE = "apprater";
    private Context context;
    
    private AppRater(final Context context) {
        this.context = context;
    }
    
    public static void appLaunched(final Context context) {
        while (true) {
            try {
                final String installerPackageName = context.getPackageManager().getInstallerPackageName(context.getPackageName());
                if (installerPackageName == null || (!installerPackageName.startsWith("com.google") && !installerPackageName.startsWith("com.android"))) {
                    return;
                }
            }
            catch (Exception ex) {
                Log.w("AppRater", (Throwable)ex);
                return;
            }
            final SharedPreferences sharedPreferences = context.getSharedPreferences("apprater", 0);
            if (sharedPreferences.getBoolean("dontshowagain", false)) {
                return;
            }
            final SharedPreferences$Editor edit = sharedPreferences.edit();
            final long n = 1L + sharedPreferences.getLong("launch_count", 0L);
            edit.putLong("launch_count", n);
            Long n2 = sharedPreferences.getLong("date_firstlaunch", 0L);
            if (n2 == 0L) {
                n2 = System.currentTimeMillis();
                edit.putLong("date_firstlaunch", (long)n2);
            }
            edit.commit();
            if (n >= 14L && System.currentTimeMillis() >= 604800000L + n2) {
                break;
            }
            return;
        }
        showRateDialog(context);
    }
    
    public static void showRateDialog(final Context context) {
        final AppRater appRater = new AppRater(context);
        final AlertDialog$Builder alertDialog$Builder = new AlertDialog$Builder(context);
        alertDialog$Builder.setTitle(2131099668);
        alertDialog$Builder.setMessage(2131099669);
        alertDialog$Builder.setPositiveButton(2131099670, (DialogInterface$OnClickListener)appRater);
        alertDialog$Builder.setNegativeButton(2131099671, (DialogInterface$OnClickListener)appRater);
        alertDialog$Builder.setNeutralButton(2131099672, (DialogInterface$OnClickListener)appRater);
        alertDialog$Builder.create().show();
    }
    
    public void onClick(final DialogInterface dialogInterface, final int n) {
        final SharedPreferences$Editor edit = this.context.getSharedPreferences("apprater", 0).edit();
        Label_0064: {
            switch (n) {
                default: {
                    edit.putLong("launch_count", 0L);
                    break;
                }
                case -1: {
                    break Label_0064;
                }
                case -2: {
                    while (true) {
                        break Label_0108;
                        try {
                            this.context.startActivity(new Intent("android.intent.action.VIEW", Uri.parse("market://details?id=" + this.context.getPackageName())));
                            edit.putBoolean("dontshowagain", true);
                            break;
                        }
                        catch (ActivityNotFoundException ex) {
                            continue;
                        }
                        break;
                    }
                    break;
                }
            }
        }
        edit.commit();
        dialogInterface.dismiss();
    }
}
